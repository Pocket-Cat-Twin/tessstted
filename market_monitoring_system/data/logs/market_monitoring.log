2025-09-17 13:11:22,820 - main - INFO - === Market Monitoring System Starting ===
2025-09-17 13:11:22,820 - main - INFO - Configuration loaded from: config.json
2025-09-17 13:11:22,821 - main - INFO - Initializing file utilities...
2025-09-17 13:11:22,821 - main - INFO - Initializing database...
2025-09-17 13:11:23,016 - core.database_manager - INFO - Database schema initialized successfully
2025-09-17 13:11:23,017 - main - INFO - Initializing image processor...
2025-09-17 13:11:23,017 - main - INFO - Initializing OCR client...
2025-09-17 13:11:23,018 - core.ocr_client - INFO - OCR client initialized with api_key auth, ocr format
2025-09-17 13:11:23,018 - main - INFO - Initializing OCR queue...
2025-09-17 13:11:23,019 - main - INFO - Initializing text parser...
2025-09-17 13:11:23,023 - core.text_parser - INFO - Compiled 10 parsing patterns
2025-09-17 13:11:23,023 - main - INFO - Initializing monitoring engine...
2025-09-17 13:11:23,023 - main - INFO - Initializing screenshot capture...
2025-09-17 13:11:23,024 - main - INFO - Initializing task scheduler...
2025-09-17 13:11:23,040 - main - INFO - Performing system health checks...
2025-09-17 13:11:23,041 - main - INFO - Checking database connectivity...
2025-09-17 13:11:23,041 - main - INFO - Database check passed - status summary: {}
2025-09-17 13:11:23,042 - main - INFO - Checking OCR API connectivity...
2025-09-17 13:11:24,405 - core.ocr_client - INFO - OCR API connection test successful
2025-09-17 13:11:24,405 - main - INFO - OCR API check passed
2025-09-17 13:11:24,406 - main - INFO - Checking file system permissions...
2025-09-17 13:11:24,408 - main - INFO - File system check passed
2025-09-17 13:11:24,408 - main - INFO - Checking configuration completeness...
2025-09-17 13:11:24,409 - main - INFO - Configuration check passed - 3 enabled hotkeys
2025-09-17 13:11:24,409 - main - INFO - System initialization completed successfully
2025-09-17 13:11:24,409 - main - INFO - Starting Market Monitoring System...
2025-09-17 13:11:24,410 - main - INFO - Starting OCR processing queue...
2025-09-17 13:11:24,412 - core.ocr_queue - INFO - OCR queue started with 2 workers
2025-09-17 13:11:24,412 - main - INFO - Starting screenshot capture system...
2025-09-17 13:11:24,412 - core.screenshot_capture - ERROR - Failed to clear hotkey handlers: '_KeyboardListener' object has no attribute 'blocking_hotkeys'
2025-09-17 13:11:24,485 - core.screenshot_capture - INFO - Registered hotkey F1 for Полная обработка товаров (цена, количество)
2025-09-17 13:11:24,485 - core.screenshot_capture - INFO - Registered hotkey F2 for Минимальная обработка связок продавец-товар
2025-09-17 13:11:24,486 - core.screenshot_capture - INFO - Registered hotkey F3 for Дополнительная полная обработка товаров
2025-09-17 13:11:24,486 - core.screenshot_capture - INFO - Registered 3 global hotkeys
2025-09-17 13:11:24,487 - core.screenshot_capture - INFO - Screenshot capture system started successfully
2025-09-17 13:11:24,487 - main - INFO - Starting task scheduler...
2025-09-17 13:11:24,487 - utils.scheduler - INFO - Starting task scheduler
2025-09-17 13:11:24,488 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,488 - utils.scheduler - INFO - Scheduled F1 processing every 30s
2025-09-17 13:11:24,489 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,489 - utils.scheduler - INFO - Scheduled F2 processing every 60s
2025-09-17 13:11:24,489 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,490 - utils.scheduler - INFO - Scheduled F3 processing every 45s
2025-09-17 13:11:24,490 - utils.scheduler - INFO - Setup 3 hotkey processing timers
2025-09-17 13:11:24,490 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,491 - utils.scheduler - INFO - Scheduled status check cycle every 10s
2025-09-17 13:11:24,529 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,530 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:11:24,531 - utils.scheduler - INFO - Scheduled maintenance tasks
2025-09-17 13:11:24,590 - apscheduler.scheduler - INFO - Added job "Process F1 screenshots" to job store "default"
2025-09-17 13:11:24,591 - apscheduler.scheduler - INFO - Added job "Process F2 screenshots" to job store "default"
2025-09-17 13:11:24,591 - apscheduler.scheduler - INFO - Added job "Process F3 screenshots" to job store "default"
2025-09-17 13:11:24,592 - apscheduler.scheduler - INFO - Added job "Status check and transition cycle" to job store "default"
2025-09-17 13:11:24,592 - apscheduler.scheduler - INFO - Added job "Daily maintenance cleanup" to job store "default"
2025-09-17 13:11:24,593 - apscheduler.scheduler - INFO - Added job "Weekly database maintenance" to job store "default"
2025-09-17 13:11:24,593 - apscheduler.scheduler - INFO - Scheduler started
2025-09-17 13:11:24,593 - utils.scheduler - INFO - Scheduler started with 6 jobs:
2025-09-17 13:11:24,594 - utils.scheduler - INFO -   - Status check and transition cycle (next run: 2025-09-17 13:11:34)
2025-09-17 13:11:24,594 - utils.scheduler - INFO -   - Process F1 screenshots (next run: 2025-09-17 13:11:54)
2025-09-17 13:11:24,594 - utils.scheduler - INFO -   - Process F3 screenshots (next run: 2025-09-17 13:12:09)
2025-09-17 13:11:24,595 - utils.scheduler - INFO -   - Process F2 screenshots (next run: 2025-09-17 13:12:24)
2025-09-17 13:11:24,595 - utils.scheduler - INFO -   - Daily maintenance cleanup (next run: 2025-09-18 02:00:00)
2025-09-17 13:11:24,596 - utils.scheduler - INFO -   - Weekly database maintenance (next run: 2025-09-21 03:00:00)
2025-09-17 13:11:24,596 - main - INFO - System started successfully with configuration: {'config_file': 'config.json', 'last_modified': '2025-09-17T13:11:17.253616', 'hotkeys': {'total': 4, 'enabled': 3, 'disabled': 1}, 'yandex_ocr': {'configured': True, 'api_url': 'https://ocr.api.cloud.yandex.net/ocr/v1/recognizeText'}, 'monitoring': {'check_interval': 10, 'cleanup_days': 30}, 'paths': {'database': 'database\\market_data.db', 'logs': 'data\\logs'}}
2025-09-17 13:11:24,596 - main - INFO - Market Monitoring System is running. Press Ctrl+C to stop.
2025-09-17 13:11:34,505 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:11:44 MSK)" (scheduled at 2025-09-17 13:11:34.490615+03:00)
2025-09-17 13:11:34,545 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:11:34,546 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:11:44 MSK)" executed successfully
2025-09-17 13:11:44,493 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:11:54 MSK)" (scheduled at 2025-09-17 13:11:44.490615+03:00)
2025-09-17 13:11:44,494 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:11:44,494 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:11:54 MSK)" executed successfully
2025-09-17 13:11:54,504 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:12:24 MSK)" (scheduled at 2025-09-17 13:11:54.488614+03:00)
2025-09-17 13:11:54,504 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:04 MSK)" (scheduled at 2025-09-17 13:11:54.490615+03:00)
2025-09-17 13:11:54,506 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:12:24 MSK)" executed successfully
2025-09-17 13:11:54,506 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:11:54,507 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:04 MSK)" executed successfully
2025-09-17 13:12:04,503 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:14 MSK)" (scheduled at 2025-09-17 13:12:04.490615+03:00)
2025-09-17 13:12:04,504 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:04,504 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:14 MSK)" executed successfully
2025-09-17 13:12:09,499 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:12:54 MSK)" (scheduled at 2025-09-17 13:12:09.489615+03:00)
2025-09-17 13:12:09,500 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:12:54 MSK)" executed successfully
2025-09-17 13:12:14,497 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:24 MSK)" (scheduled at 2025-09-17 13:12:14.490615+03:00)
2025-09-17 13:12:14,498 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:14,498 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:24 MSK)" executed successfully
2025-09-17 13:12:17,044 - core.screenshot_capture - INFO - Hotkey F2 pressed - capturing screenshot
2025-09-17 13:12:17,699 - core.screenshot_capture - INFO - Screenshot captured successfully: F2_20250917_131217_044_bd371579.png (700x500) in 0.654s
2025-09-17 13:12:18,035 - core.screenshot_capture - INFO - Hotkey F2 pressed - capturing screenshot
2025-09-17 13:12:18,242 - core.screenshot_capture - INFO - Screenshot captured successfully: F2_20250917_131218_036_0248d764.png (700x500) in 0.206s
2025-09-17 13:12:24,492 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:12:54 MSK)" (scheduled at 2025-09-17 13:12:24.488614+03:00)
2025-09-17 13:12:24,492 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:13:24 MSK)" (scheduled at 2025-09-17 13:12:24.489615+03:00)
2025-09-17 13:12:24,492 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:34 MSK)" (scheduled at 2025-09-17 13:12:24.490615+03:00)
2025-09-17 13:12:24,494 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:12:54 MSK)" executed successfully
2025-09-17 13:12:24,494 - core.image_processor - INFO - Processing 2 screenshots for F2
2025-09-17 13:12:24,495 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:24,495 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:34 MSK)" executed successfully
2025-09-17 13:12:24,645 - core.image_processor - INFO - Successfully merged 2 images into merged_20250917_131224_561_10ea582c.jpg (700x1000) in 0.150s
2025-09-17 13:12:24,649 - core.image_processor - INFO - Cleaned up source files: 2 successful, 0 failed
2025-09-17 13:12:24,650 - core.database_manager - INFO - Created OCR session 1 for hotkey F2
2025-09-17 13:12:24,651 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758103944_fccb619a for F2 (session 1)
2025-09-17 13:12:24,651 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758103944_fccb619a (attempt 1)
2025-09-17 13:12:24,651 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:13:24 MSK)" executed successfully
2025-09-17 13:12:24,652 - core.ocr_client - INFO - Starting OCR request 151fd41b for merged_20250917_131224_561_10ea582c.jpg (0.1MB)
2025-09-17 13:12:24,652 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:12:25,263 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 151fd41b: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:12:25,264 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:12:26,437 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 151fd41b: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "d87e990f-91af-4539-9afd-0a6797ef1944"
  }
 ]
}

2025-09-17 13:12:26,438 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:12:26,438 - core.ocr_queue - ERROR - Job ocr_F2_1758103944_fccb619a failed on attempt 1: OCR processing returned no result
2025-09-17 13:12:26,438 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758103944_fccb619a for retry in 2s
2025-09-17 13:12:28,440 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758103944_fccb619a (attempt 2)
2025-09-17 13:12:28,440 - core.ocr_client - INFO - Starting OCR request f0894295 for merged_20250917_131224_561_10ea582c.jpg (0.1MB)
2025-09-17 13:12:28,441 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:12:28,565 - core.ocr_client - ERROR - Non-retryable error for primary-ocr f0894295: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:12:28,565 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:12:28,638 - core.ocr_client - ERROR - Non-retryable error for fallback-vision f0894295: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "f3a0e561-14a2-4de4-8b7c-2a7719aea0a0"
  }
 ]
}

2025-09-17 13:12:28,639 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:12:28,640 - core.ocr_queue - ERROR - Job ocr_F2_1758103944_fccb619a failed on attempt 2: OCR processing returned no result
2025-09-17 13:12:28,640 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758103944_fccb619a for retry in 4s
2025-09-17 13:12:32,642 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758103944_fccb619a (attempt 3)
2025-09-17 13:12:32,642 - core.ocr_client - INFO - Starting OCR request b179809e for merged_20250917_131224_561_10ea582c.jpg (0.1MB)
2025-09-17 13:12:32,643 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:12:32,794 - core.ocr_client - ERROR - Non-retryable error for primary-ocr b179809e: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:12:32,795 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:12:32,892 - core.ocr_client - ERROR - Non-retryable error for fallback-vision b179809e: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "4fdb0708-6e6a-4aed-82f2-098678f04ca3"
  }
 ]
}

2025-09-17 13:12:32,893 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:12:32,894 - core.ocr_queue - ERROR - Job ocr_F2_1758103944_fccb619a failed on attempt 3: OCR processing returned no result
2025-09-17 13:12:32,894 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758103944_fccb619a)
2025-09-17 13:12:32,904 - core.ocr_queue - ERROR - Job ocr_F2_1758103944_fccb619a permanently failed: OCR processing returned no result
2025-09-17 13:12:34,505 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:44 MSK)" (scheduled at 2025-09-17 13:12:34.490615+03:00)
2025-09-17 13:12:34,506 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:34,506 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:44 MSK)" executed successfully
2025-09-17 13:12:44,493 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:54 MSK)" (scheduled at 2025-09-17 13:12:44.490615+03:00)
2025-09-17 13:12:44,494 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:44,494 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:12:54 MSK)" executed successfully
2025-09-17 13:12:54,496 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:13:24 MSK)" (scheduled at 2025-09-17 13:12:54.488614+03:00)
2025-09-17 13:12:54,496 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:13:39 MSK)" (scheduled at 2025-09-17 13:12:54.489615+03:00)
2025-09-17 13:12:54,496 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:13:04 MSK)" (scheduled at 2025-09-17 13:12:54.490615+03:00)
2025-09-17 13:12:54,497 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:13:24 MSK)" executed successfully
2025-09-17 13:12:54,497 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:12:54,497 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:13:39 MSK)" executed successfully
2025-09-17 13:12:54,498 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:13:04 MSK)" executed successfully
2025-09-17 13:12:57,808 - main - INFO - Received SIGINT, initiating shutdown...
2025-09-17 13:12:57,809 - main - INFO - Shutting down Market Monitoring System...
2025-09-17 13:12:57,809 - main - INFO - Stopping task scheduler...
2025-09-17 13:12:57,810 - utils.scheduler - INFO - Stopping task scheduler
2025-09-17 13:12:57,810 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-09-17 13:12:57,811 - utils.scheduler - INFO - Task scheduler stopped
2025-09-17 13:12:57,811 - main - INFO - Stopping screenshot capture...
2025-09-17 13:12:57,812 - core.screenshot_capture - ERROR - Error closing MSS instance: '_thread._local' object has no attribute 'bmp'
2025-09-17 13:12:57,812 - core.screenshot_capture - INFO - Screenshot capture system stopped
2025-09-17 13:12:57,812 - main - INFO - Stopping OCR queue...
2025-09-17 13:12:57,813 - core.ocr_queue - INFO - Stopping OCR queue...
2025-09-17 13:12:58,389 - core.ocr_queue - INFO - OCR queue stopped
2025-09-17 13:12:58,389 - main - INFO - Closing OCR client...
2025-09-17 13:12:58,392 - core.ocr_client - INFO - OCR client closed
2025-09-17 13:12:58,392 - main - INFO - Closing database connections...
2025-09-17 13:12:58,393 - main - INFO - System shutdown completed
2025-09-17 13:25:36,802 - main - INFO - === Market Monitoring System Starting ===
2025-09-17 13:25:36,803 - main - INFO - Configuration loaded from: config.json
2025-09-17 13:25:36,803 - main - INFO - Initializing file utilities...
2025-09-17 13:25:36,803 - main - INFO - Initializing database...
2025-09-17 13:25:36,806 - core.database_manager - INFO - Database schema initialized successfully
2025-09-17 13:25:36,806 - main - INFO - Initializing image processor...
2025-09-17 13:25:36,807 - main - INFO - Initializing OCR client...
2025-09-17 13:25:36,807 - core.ocr_client - INFO - OCR client initialized with api_key auth, ocr format
2025-09-17 13:25:36,808 - main - INFO - Initializing OCR queue...
2025-09-17 13:25:36,808 - main - INFO - Initializing text parser...
2025-09-17 13:25:36,811 - core.text_parser - INFO - Compiled 10 parsing patterns
2025-09-17 13:25:36,812 - main - INFO - Initializing monitoring engine...
2025-09-17 13:25:36,812 - main - INFO - Initializing screenshot capture...
2025-09-17 13:25:36,812 - main - INFO - Initializing task scheduler...
2025-09-17 13:25:36,815 - main - INFO - Performing system health checks...
2025-09-17 13:25:36,816 - main - INFO - Checking database connectivity...
2025-09-17 13:25:36,816 - main - INFO - Database check passed - status summary: {}
2025-09-17 13:25:36,816 - main - INFO - Checking OCR API connectivity...
2025-09-17 13:25:37,571 - core.ocr_client - INFO - OCR API connection test successful
2025-09-17 13:25:37,571 - main - INFO - OCR API check passed
2025-09-17 13:25:37,572 - main - INFO - Checking file system permissions...
2025-09-17 13:25:37,574 - main - INFO - File system check passed
2025-09-17 13:25:37,574 - main - INFO - Checking configuration completeness...
2025-09-17 13:25:37,574 - main - INFO - Configuration check passed - 3 enabled hotkeys
2025-09-17 13:25:37,575 - main - INFO - System initialization completed successfully
2025-09-17 13:25:37,575 - main - INFO - Starting Market Monitoring System...
2025-09-17 13:25:37,575 - main - INFO - Starting OCR processing queue...
2025-09-17 13:25:37,576 - core.ocr_queue - INFO - OCR queue started with 2 workers
2025-09-17 13:25:37,577 - main - INFO - Starting screenshot capture system...
2025-09-17 13:25:37,577 - core.screenshot_capture - ERROR - Failed to clear hotkey handlers: '_KeyboardListener' object has no attribute 'blocking_hotkeys'
2025-09-17 13:25:37,648 - core.screenshot_capture - INFO - Registered hotkey F1 for Полная обработка товаров (цена, количество)
2025-09-17 13:25:37,648 - core.screenshot_capture - INFO - Registered hotkey F2 for Минимальная обработка связок продавец-товар
2025-09-17 13:25:37,649 - core.screenshot_capture - INFO - Registered hotkey F3 for Дополнительная полная обработка товаров
2025-09-17 13:25:37,649 - core.screenshot_capture - INFO - Registered 3 global hotkeys
2025-09-17 13:25:37,650 - core.screenshot_capture - INFO - Screenshot capture system started successfully
2025-09-17 13:25:37,650 - main - INFO - Starting task scheduler...
2025-09-17 13:25:37,651 - utils.scheduler - INFO - Starting task scheduler
2025-09-17 13:25:37,651 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,651 - utils.scheduler - INFO - Scheduled F1 processing every 30s
2025-09-17 13:25:37,652 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,652 - utils.scheduler - INFO - Scheduled F2 processing every 60s
2025-09-17 13:25:37,653 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,653 - utils.scheduler - INFO - Scheduled F3 processing every 45s
2025-09-17 13:25:37,653 - utils.scheduler - INFO - Setup 3 hotkey processing timers
2025-09-17 13:25:37,654 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,654 - utils.scheduler - INFO - Scheduled status check cycle every 10s
2025-09-17 13:25:37,655 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,656 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-09-17 13:25:37,656 - utils.scheduler - INFO - Scheduled maintenance tasks
2025-09-17 13:25:37,657 - apscheduler.scheduler - INFO - Added job "Process F1 screenshots" to job store "default"
2025-09-17 13:25:37,658 - apscheduler.scheduler - INFO - Added job "Process F2 screenshots" to job store "default"
2025-09-17 13:25:37,658 - apscheduler.scheduler - INFO - Added job "Process F3 screenshots" to job store "default"
2025-09-17 13:25:37,658 - apscheduler.scheduler - INFO - Added job "Status check and transition cycle" to job store "default"
2025-09-17 13:25:37,659 - apscheduler.scheduler - INFO - Added job "Daily maintenance cleanup" to job store "default"
2025-09-17 13:25:37,659 - apscheduler.scheduler - INFO - Added job "Weekly database maintenance" to job store "default"
2025-09-17 13:25:37,660 - apscheduler.scheduler - INFO - Scheduler started
2025-09-17 13:25:37,660 - utils.scheduler - INFO - Scheduler started with 6 jobs:
2025-09-17 13:25:37,661 - utils.scheduler - INFO -   - Status check and transition cycle (next run: 2025-09-17 13:25:47)
2025-09-17 13:25:37,661 - utils.scheduler - INFO -   - Process F1 screenshots (next run: 2025-09-17 13:26:07)
2025-09-17 13:25:37,662 - utils.scheduler - INFO -   - Process F3 screenshots (next run: 2025-09-17 13:26:22)
2025-09-17 13:25:37,663 - utils.scheduler - INFO -   - Process F2 screenshots (next run: 2025-09-17 13:26:37)
2025-09-17 13:25:37,663 - utils.scheduler - INFO -   - Daily maintenance cleanup (next run: 2025-09-18 02:00:00)
2025-09-17 13:25:37,664 - utils.scheduler - INFO -   - Weekly database maintenance (next run: 2025-09-21 03:00:00)
2025-09-17 13:25:37,664 - main - INFO - System started successfully with configuration: {'config_file': 'config.json', 'last_modified': '2025-09-17T13:25:26.864936', 'hotkeys': {'total': 4, 'enabled': 3, 'disabled': 1}, 'yandex_ocr': {'configured': True, 'api_url': 'https://ocr.api.cloud.yandex.net/ocr/v1/recognizeText'}, 'monitoring': {'check_interval': 10, 'cleanup_days': 30}, 'paths': {'database': 'database\\market_data.db', 'logs': 'data\\logs'}}
2025-09-17 13:25:37,664 - main - INFO - Market Monitoring System is running. Press Ctrl+C to stop.
2025-09-17 13:25:47,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:25:57 MSK)" (scheduled at 2025-09-17 13:25:47.654805+03:00)
2025-09-17 13:25:47,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:25:47,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:25:57 MSK)" executed successfully
2025-09-17 13:25:57,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:07 MSK)" (scheduled at 2025-09-17 13:25:57.654805+03:00)
2025-09-17 13:25:57,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:25:57,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:07 MSK)" executed successfully
2025-09-17 13:26:07,655 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:26:37 MSK)" (scheduled at 2025-09-17 13:26:07.651806+03:00)
2025-09-17 13:26:07,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:17 MSK)" (scheduled at 2025-09-17 13:26:07.654805+03:00)
2025-09-17 13:26:07,657 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:26:37 MSK)" executed successfully
2025-09-17 13:26:07,657 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:07,658 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:17 MSK)" executed successfully
2025-09-17 13:26:17,667 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:27 MSK)" (scheduled at 2025-09-17 13:26:17.654805+03:00)
2025-09-17 13:26:17,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:17,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:27 MSK)" executed successfully
2025-09-17 13:26:22,669 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:27:07 MSK)" (scheduled at 2025-09-17 13:26:22.653805+03:00)
2025-09-17 13:26:22,670 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:27:07 MSK)" executed successfully
2025-09-17 13:26:22,844 - core.screenshot_capture - INFO - Hotkey F2 pressed - capturing screenshot
2025-09-17 13:26:22,946 - core.screenshot_capture - INFO - Screenshot captured successfully: F2_20250917_132622_845_1efa910b.png (285x400) in 0.101s
2025-09-17 13:26:27,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:37 MSK)" (scheduled at 2025-09-17 13:26:27.654805+03:00)
2025-09-17 13:26:27,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:27,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:37 MSK)" executed successfully
2025-09-17 13:26:37,660 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:27:07 MSK)" (scheduled at 2025-09-17 13:26:37.651806+03:00)
2025-09-17 13:26:37,660 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:27:37 MSK)" (scheduled at 2025-09-17 13:26:37.652805+03:00)
2025-09-17 13:26:37,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:47 MSK)" (scheduled at 2025-09-17 13:26:37.654805+03:00)
2025-09-17 13:26:37,662 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:27:07 MSK)" executed successfully
2025-09-17 13:26:37,662 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:26:37,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:37,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:47 MSK)" executed successfully
2025-09-17 13:26:37,911 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_132637_692_8b1d1497.jpg (700x1400) in 0.248s
2025-09-17 13:26:37,915 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:26:37,915 - core.database_manager - INFO - Created OCR session 2 for hotkey F2
2025-09-17 13:26:37,929 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758104797_6bb4d4b4 for F2 (session 2)
2025-09-17 13:26:37,929 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104797_6bb4d4b4 (attempt 1)
2025-09-17 13:26:37,930 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:27:37 MSK)" executed successfully
2025-09-17 13:26:37,930 - core.ocr_client - INFO - Starting OCR request 9d808b56 for merged_20250917_132637_692_8b1d1497.jpg (0.1MB)
2025-09-17 13:26:37,931 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:26:38,431 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 9d808b56: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:26:38,432 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:26:38,711 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 9d808b56: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "d5c729af-b8e2-4d96-91f3-e9488fb4080b"
  }
 ]
}

2025-09-17 13:26:38,712 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:26:38,713 - core.ocr_queue - ERROR - Job ocr_F2_1758104797_6bb4d4b4 failed on attempt 1: OCR processing returned no result
2025-09-17 13:26:38,713 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104797_6bb4d4b4 for retry in 2s
2025-09-17 13:26:40,715 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104797_6bb4d4b4 (attempt 2)
2025-09-17 13:26:40,715 - core.ocr_client - INFO - Starting OCR request ee548949 for merged_20250917_132637_692_8b1d1497.jpg (0.1MB)
2025-09-17 13:26:40,716 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:26:40,795 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ee548949: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:26:40,796 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:26:40,845 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ee548949: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "ff7cef32-8ff8-4246-8d10-7494ebf67be2"
  }
 ]
}

2025-09-17 13:26:40,846 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:26:40,847 - core.ocr_queue - ERROR - Job ocr_F2_1758104797_6bb4d4b4 failed on attempt 2: OCR processing returned no result
2025-09-17 13:26:40,847 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104797_6bb4d4b4 for retry in 4s
2025-09-17 13:26:44,848 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104797_6bb4d4b4 (attempt 3)
2025-09-17 13:26:44,848 - core.ocr_client - INFO - Starting OCR request fd78c6e8 for merged_20250917_132637_692_8b1d1497.jpg (0.1MB)
2025-09-17 13:26:44,849 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:26:44,941 - core.ocr_client - ERROR - Non-retryable error for primary-ocr fd78c6e8: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:26:44,941 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:26:44,980 - core.ocr_client - ERROR - Non-retryable error for fallback-vision fd78c6e8: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "e13d3381-c1b3-4965-a819-d8d710aed85c"
  }
 ]
}

2025-09-17 13:26:44,981 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:26:44,982 - core.ocr_queue - ERROR - Job ocr_F2_1758104797_6bb4d4b4 failed on attempt 3: OCR processing returned no result
2025-09-17 13:26:44,982 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758104797_6bb4d4b4)
2025-09-17 13:26:44,989 - core.ocr_queue - ERROR - Job ocr_F2_1758104797_6bb4d4b4 permanently failed: OCR processing returned no result
2025-09-17 13:26:47,670 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:57 MSK)" (scheduled at 2025-09-17 13:26:47.654805+03:00)
2025-09-17 13:26:47,671 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:47,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:26:57 MSK)" executed successfully
2025-09-17 13:26:57,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:07 MSK)" (scheduled at 2025-09-17 13:26:57.654805+03:00)
2025-09-17 13:26:57,667 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:26:57,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:07 MSK)" executed successfully
2025-09-17 13:27:07,662 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:27:37 MSK)" (scheduled at 2025-09-17 13:27:07.651806+03:00)
2025-09-17 13:27:07,662 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:27:52 MSK)" (scheduled at 2025-09-17 13:27:07.653805+03:00)
2025-09-17 13:27:07,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:17 MSK)" (scheduled at 2025-09-17 13:27:07.654805+03:00)
2025-09-17 13:27:07,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:27:37 MSK)" executed successfully
2025-09-17 13:27:07,664 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:27:52 MSK)" executed successfully
2025-09-17 13:27:07,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:07,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:17 MSK)" executed successfully
2025-09-17 13:27:17,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:27 MSK)" (scheduled at 2025-09-17 13:27:17.654805+03:00)
2025-09-17 13:27:17,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:17,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:27 MSK)" executed successfully
2025-09-17 13:27:27,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:37 MSK)" (scheduled at 2025-09-17 13:27:27.654805+03:00)
2025-09-17 13:27:27,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:27,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:37 MSK)" executed successfully
2025-09-17 13:27:37,655 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:28:07 MSK)" (scheduled at 2025-09-17 13:27:37.651806+03:00)
2025-09-17 13:27:37,655 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:28:37 MSK)" (scheduled at 2025-09-17 13:27:37.652805+03:00)
2025-09-17 13:27:37,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:47 MSK)" (scheduled at 2025-09-17 13:27:37.654805+03:00)
2025-09-17 13:27:37,656 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:28:07 MSK)" executed successfully
2025-09-17 13:27:37,657 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:37,657 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:27:37,657 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:47 MSK)" executed successfully
2025-09-17 13:27:38,101 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_132737_677_9f93754b.jpg (700x1400) in 0.444s
2025-09-17 13:27:38,105 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:27:38,105 - core.database_manager - INFO - Created OCR session 3 for hotkey F2
2025-09-17 13:27:38,106 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758104858_848cfda4 for F2 (session 3)
2025-09-17 13:27:38,106 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104858_848cfda4 (attempt 1)
2025-09-17 13:27:38,106 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:28:37 MSK)" executed successfully
2025-09-17 13:27:38,106 - core.ocr_client - INFO - Starting OCR request 83e5d847 for merged_20250917_132737_677_9f93754b.jpg (0.1MB)
2025-09-17 13:27:38,107 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:27:38,213 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 83e5d847: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:27:38,214 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:27:38,255 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 83e5d847: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "0063331e-2246-4573-81ca-d3fcdb300e49"
  }
 ]
}

2025-09-17 13:27:38,255 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:27:38,256 - core.ocr_queue - ERROR - Job ocr_F2_1758104858_848cfda4 failed on attempt 1: OCR processing returned no result
2025-09-17 13:27:38,256 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104858_848cfda4 for retry in 2s
2025-09-17 13:27:40,257 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104858_848cfda4 (attempt 2)
2025-09-17 13:27:40,257 - core.ocr_client - INFO - Starting OCR request 76b3ff49 for merged_20250917_132737_677_9f93754b.jpg (0.1MB)
2025-09-17 13:27:40,258 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:27:40,341 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 76b3ff49: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:27:40,342 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:27:40,378 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 76b3ff49: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "e02cdc8c-11b2-4887-a19c-3d1b645be2b1"
  }
 ]
}

2025-09-17 13:27:40,379 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:27:40,380 - core.ocr_queue - ERROR - Job ocr_F2_1758104858_848cfda4 failed on attempt 2: OCR processing returned no result
2025-09-17 13:27:40,380 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104858_848cfda4 for retry in 4s
2025-09-17 13:27:44,382 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104858_848cfda4 (attempt 3)
2025-09-17 13:27:44,382 - core.ocr_client - INFO - Starting OCR request b96b84a8 for merged_20250917_132737_677_9f93754b.jpg (0.1MB)
2025-09-17 13:27:44,383 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:27:44,471 - core.ocr_client - ERROR - Non-retryable error for primary-ocr b96b84a8: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:27:44,471 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:27:44,515 - core.ocr_client - ERROR - Non-retryable error for fallback-vision b96b84a8: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "4bb45deb-29a6-49c0-871f-7087f35cb31f"
  }
 ]
}

2025-09-17 13:27:44,516 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:27:44,517 - core.ocr_queue - ERROR - Job ocr_F2_1758104858_848cfda4 failed on attempt 3: OCR processing returned no result
2025-09-17 13:27:44,517 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758104858_848cfda4)
2025-09-17 13:27:44,518 - core.ocr_queue - ERROR - Job ocr_F2_1758104858_848cfda4 permanently failed: OCR processing returned no result
2025-09-17 13:27:47,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:57 MSK)" (scheduled at 2025-09-17 13:27:47.654805+03:00)
2025-09-17 13:27:47,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:47,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:27:57 MSK)" executed successfully
2025-09-17 13:27:52,657 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:28:37 MSK)" (scheduled at 2025-09-17 13:27:52.653805+03:00)
2025-09-17 13:27:52,658 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:28:37 MSK)" executed successfully
2025-09-17 13:27:57,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:07 MSK)" (scheduled at 2025-09-17 13:27:57.654805+03:00)
2025-09-17 13:27:57,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:27:57,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:07 MSK)" executed successfully
2025-09-17 13:28:07,654 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:28:37 MSK)" (scheduled at 2025-09-17 13:28:07.651806+03:00)
2025-09-17 13:28:07,655 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:28:37 MSK)" executed successfully
2025-09-17 13:28:07,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:17 MSK)" (scheduled at 2025-09-17 13:28:07.654805+03:00)
2025-09-17 13:28:07,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:07,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:17 MSK)" executed successfully
2025-09-17 13:28:17,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:27 MSK)" (scheduled at 2025-09-17 13:28:17.654805+03:00)
2025-09-17 13:28:17,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:17,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:27 MSK)" executed successfully
2025-09-17 13:28:27,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:37 MSK)" (scheduled at 2025-09-17 13:28:27.654805+03:00)
2025-09-17 13:28:27,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:27,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:37 MSK)" executed successfully
2025-09-17 13:28:37,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:29:07 MSK)" (scheduled at 2025-09-17 13:28:37.651806+03:00)
2025-09-17 13:28:37,663 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:29:37 MSK)" (scheduled at 2025-09-17 13:28:37.652805+03:00)
2025-09-17 13:28:37,663 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:29:22 MSK)" (scheduled at 2025-09-17 13:28:37.653805+03:00)
2025-09-17 13:28:37,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:47 MSK)" (scheduled at 2025-09-17 13:28:37.654805+03:00)
2025-09-17 13:28:37,665 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:29:07 MSK)" executed successfully
2025-09-17 13:28:37,666 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:28:37,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:37,666 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:29:22 MSK)" executed successfully
2025-09-17 13:28:37,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:47 MSK)" executed successfully
2025-09-17 13:28:37,749 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_132837_692_1ea33a42.jpg (700x1400) in 0.083s
2025-09-17 13:28:37,753 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:28:37,753 - core.database_manager - INFO - Created OCR session 4 for hotkey F2
2025-09-17 13:28:37,754 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758104917_11390285 for F2 (session 4)
2025-09-17 13:28:37,754 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104917_11390285 (attempt 1)
2025-09-17 13:28:37,754 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:29:37 MSK)" executed successfully
2025-09-17 13:28:37,754 - core.ocr_client - INFO - Starting OCR request 7c3a8d0a for merged_20250917_132837_692_1ea33a42.jpg (0.1MB)
2025-09-17 13:28:37,755 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:28:37,857 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 7c3a8d0a: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:28:37,858 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:28:37,892 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 7c3a8d0a: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "caa86ba9-2b19-4885-8c71-2b7f3461a8c5"
  }
 ]
}

2025-09-17 13:28:37,893 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:28:37,894 - core.ocr_queue - ERROR - Job ocr_F2_1758104917_11390285 failed on attempt 1: OCR processing returned no result
2025-09-17 13:28:37,894 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104917_11390285 for retry in 2s
2025-09-17 13:28:39,896 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104917_11390285 (attempt 2)
2025-09-17 13:28:39,896 - core.ocr_client - INFO - Starting OCR request 313445ba for merged_20250917_132837_692_1ea33a42.jpg (0.1MB)
2025-09-17 13:28:39,897 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:28:39,989 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 313445ba: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:28:39,990 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:28:40,024 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 313445ba: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "8816a8dd-93a4-4775-a3f8-310614ab3bd8"
  }
 ]
}

2025-09-17 13:28:40,025 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:28:40,025 - core.ocr_queue - ERROR - Job ocr_F2_1758104917_11390285 failed on attempt 2: OCR processing returned no result
2025-09-17 13:28:40,026 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104917_11390285 for retry in 4s
2025-09-17 13:28:44,028 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104917_11390285 (attempt 3)
2025-09-17 13:28:44,028 - core.ocr_client - INFO - Starting OCR request 4c5e49d7 for merged_20250917_132837_692_1ea33a42.jpg (0.1MB)
2025-09-17 13:28:44,029 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:28:44,269 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 4c5e49d7: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:28:44,270 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:28:44,308 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 4c5e49d7: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "f087a395-b21b-485f-a14d-da056a1bf536"
  }
 ]
}

2025-09-17 13:28:44,309 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:28:44,310 - core.ocr_queue - ERROR - Job ocr_F2_1758104917_11390285 failed on attempt 3: OCR processing returned no result
2025-09-17 13:28:44,310 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758104917_11390285)
2025-09-17 13:28:44,311 - core.ocr_queue - ERROR - Job ocr_F2_1758104917_11390285 permanently failed: OCR processing returned no result
2025-09-17 13:28:47,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:57 MSK)" (scheduled at 2025-09-17 13:28:47.654805+03:00)
2025-09-17 13:28:47,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:47,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:28:57 MSK)" executed successfully
2025-09-17 13:28:57,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:07 MSK)" (scheduled at 2025-09-17 13:28:57.654805+03:00)
2025-09-17 13:28:57,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:28:57,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:07 MSK)" executed successfully
2025-09-17 13:29:07,652 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:29:37 MSK)" (scheduled at 2025-09-17 13:29:07.651806+03:00)
2025-09-17 13:29:07,653 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:29:37 MSK)" executed successfully
2025-09-17 13:29:07,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:17 MSK)" (scheduled at 2025-09-17 13:29:07.654805+03:00)
2025-09-17 13:29:07,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:07,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:17 MSK)" executed successfully
2025-09-17 13:29:17,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:27 MSK)" (scheduled at 2025-09-17 13:29:17.654805+03:00)
2025-09-17 13:29:17,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:17,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:27 MSK)" executed successfully
2025-09-17 13:29:22,667 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:30:07 MSK)" (scheduled at 2025-09-17 13:29:22.653805+03:00)
2025-09-17 13:29:22,668 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:30:07 MSK)" executed successfully
2025-09-17 13:29:27,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:37 MSK)" (scheduled at 2025-09-17 13:29:27.654805+03:00)
2025-09-17 13:29:27,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:27,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:37 MSK)" executed successfully
2025-09-17 13:29:37,661 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:30:07 MSK)" (scheduled at 2025-09-17 13:29:37.651806+03:00)
2025-09-17 13:29:37,661 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:30:37 MSK)" (scheduled at 2025-09-17 13:29:37.652805+03:00)
2025-09-17 13:29:37,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:47 MSK)" (scheduled at 2025-09-17 13:29:37.654805+03:00)
2025-09-17 13:29:37,662 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:30:07 MSK)" executed successfully
2025-09-17 13:29:37,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:37,663 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:29:37,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:47 MSK)" executed successfully
2025-09-17 13:29:37,733 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_132937_682_4c7a5878.jpg (700x1400) in 0.069s
2025-09-17 13:29:37,736 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:29:37,736 - core.database_manager - INFO - Created OCR session 5 for hotkey F2
2025-09-17 13:29:37,737 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758104977_611504c6 for F2 (session 5)
2025-09-17 13:29:37,737 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104977_611504c6 (attempt 1)
2025-09-17 13:29:37,737 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:30:37 MSK)" executed successfully
2025-09-17 13:29:37,738 - core.ocr_client - INFO - Starting OCR request 837775f8 for merged_20250917_132937_682_4c7a5878.jpg (0.1MB)
2025-09-17 13:29:37,738 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:29:37,829 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 837775f8: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:29:37,830 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:29:37,866 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 837775f8: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "d9f61a3e-977b-4b8c-805a-0dd7b19e67bb"
  }
 ]
}

2025-09-17 13:29:37,867 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:29:37,867 - core.ocr_queue - ERROR - Job ocr_F2_1758104977_611504c6 failed on attempt 1: OCR processing returned no result
2025-09-17 13:29:37,867 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104977_611504c6 for retry in 2s
2025-09-17 13:29:39,869 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104977_611504c6 (attempt 2)
2025-09-17 13:29:39,869 - core.ocr_client - INFO - Starting OCR request 49c17df8 for merged_20250917_132937_682_4c7a5878.jpg (0.1MB)
2025-09-17 13:29:39,870 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:29:39,959 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 49c17df8: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:29:39,960 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:29:39,995 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 49c17df8: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "b513a7e1-b64a-4fd0-8c42-b9c1f1cbf856"
  }
 ]
}

2025-09-17 13:29:39,996 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:29:39,996 - core.ocr_queue - ERROR - Job ocr_F2_1758104977_611504c6 failed on attempt 2: OCR processing returned no result
2025-09-17 13:29:39,997 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758104977_611504c6 for retry in 4s
2025-09-17 13:29:43,999 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758104977_611504c6 (attempt 3)
2025-09-17 13:29:43,999 - core.ocr_client - INFO - Starting OCR request 4e570703 for merged_20250917_132937_682_4c7a5878.jpg (0.1MB)
2025-09-17 13:29:44,000 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:29:44,163 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 4e570703: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:29:44,164 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:29:44,213 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 4e570703: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "7ca72e13-a1eb-4731-971a-fefd29c57702"
  }
 ]
}

2025-09-17 13:29:44,214 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:29:44,214 - core.ocr_queue - ERROR - Job ocr_F2_1758104977_611504c6 failed on attempt 3: OCR processing returned no result
2025-09-17 13:29:44,215 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758104977_611504c6)
2025-09-17 13:29:44,215 - core.ocr_queue - ERROR - Job ocr_F2_1758104977_611504c6 permanently failed: OCR processing returned no result
2025-09-17 13:29:47,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:57 MSK)" (scheduled at 2025-09-17 13:29:47.654805+03:00)
2025-09-17 13:29:47,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:47,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:29:57 MSK)" executed successfully
2025-09-17 13:29:57,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:07 MSK)" (scheduled at 2025-09-17 13:29:57.654805+03:00)
2025-09-17 13:29:57,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:29:57,662 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:07 MSK)" executed successfully
2025-09-17 13:30:00,812 - main - WARNING - Monitoring engine health issues: ['No items in monitoring queue']
2025-09-17 13:30:00,812 - main - WARNING - Periodic health check failed: 'int' object has no attribute 'name'
2025-09-17 13:30:07,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:30:37 MSK)" (scheduled at 2025-09-17 13:30:07.651806+03:00)
2025-09-17 13:30:07,663 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:30:52 MSK)" (scheduled at 2025-09-17 13:30:07.653805+03:00)
2025-09-17 13:30:07,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:17 MSK)" (scheduled at 2025-09-17 13:30:07.654805+03:00)
2025-09-17 13:30:07,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:30:37 MSK)" executed successfully
2025-09-17 13:30:07,665 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:30:52 MSK)" executed successfully
2025-09-17 13:30:07,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:07,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:17 MSK)" executed successfully
2025-09-17 13:30:17,657 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:27 MSK)" (scheduled at 2025-09-17 13:30:17.654805+03:00)
2025-09-17 13:30:17,658 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:17,658 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:27 MSK)" executed successfully
2025-09-17 13:30:27,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:37 MSK)" (scheduled at 2025-09-17 13:30:27.654805+03:00)
2025-09-17 13:30:27,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:27,662 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:37 MSK)" executed successfully
2025-09-17 13:30:37,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:31:07 MSK)" (scheduled at 2025-09-17 13:30:37.651806+03:00)
2025-09-17 13:30:37,663 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:31:37 MSK)" (scheduled at 2025-09-17 13:30:37.652805+03:00)
2025-09-17 13:30:37,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:47 MSK)" (scheduled at 2025-09-17 13:30:37.654805+03:00)
2025-09-17 13:30:37,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:31:07 MSK)" executed successfully
2025-09-17 13:30:37,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:37,665 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:30:37,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:47 MSK)" executed successfully
2025-09-17 13:30:37,763 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133037_706_09786aa9.jpg (700x1400) in 0.097s
2025-09-17 13:30:37,768 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:30:37,768 - core.database_manager - INFO - Created OCR session 6 for hotkey F2
2025-09-17 13:30:37,769 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105037_f0acebfd for F2 (session 6)
2025-09-17 13:30:37,769 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105037_f0acebfd (attempt 1)
2025-09-17 13:30:37,769 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:31:37 MSK)" executed successfully
2025-09-17 13:30:37,770 - core.ocr_client - INFO - Starting OCR request 686b004a for merged_20250917_133037_706_09786aa9.jpg (0.1MB)
2025-09-17 13:30:37,770 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:30:37,848 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 686b004a: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:30:37,849 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:30:37,887 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 686b004a: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "267b562d-9d34-42cc-af6c-b44f0a0fdd81"
  }
 ]
}

2025-09-17 13:30:37,888 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:30:37,888 - core.ocr_queue - ERROR - Job ocr_F2_1758105037_f0acebfd failed on attempt 1: OCR processing returned no result
2025-09-17 13:30:37,889 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105037_f0acebfd for retry in 2s
2025-09-17 13:30:39,890 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105037_f0acebfd (attempt 2)
2025-09-17 13:30:39,891 - core.ocr_client - INFO - Starting OCR request ee416b0e for merged_20250917_133037_706_09786aa9.jpg (0.1MB)
2025-09-17 13:30:39,891 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:30:39,971 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ee416b0e: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:30:39,972 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:30:40,009 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ee416b0e: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "1b032602-4923-413f-84a3-900c3cd624a4"
  }
 ]
}

2025-09-17 13:30:40,012 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:30:40,013 - core.ocr_queue - ERROR - Job ocr_F2_1758105037_f0acebfd failed on attempt 2: OCR processing returned no result
2025-09-17 13:30:40,014 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105037_f0acebfd for retry in 4s
2025-09-17 13:30:44,016 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105037_f0acebfd (attempt 3)
2025-09-17 13:30:44,016 - core.ocr_client - INFO - Starting OCR request ce8c8d67 for merged_20250917_133037_706_09786aa9.jpg (0.1MB)
2025-09-17 13:30:44,017 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:30:44,191 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ce8c8d67: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:30:44,192 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:30:44,241 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ce8c8d67: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "e646fbca-507b-4acc-82c8-e9584cf55ae6"
  }
 ]
}

2025-09-17 13:30:44,242 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:30:44,242 - core.ocr_queue - ERROR - Job ocr_F2_1758105037_f0acebfd failed on attempt 3: OCR processing returned no result
2025-09-17 13:30:44,242 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105037_f0acebfd)
2025-09-17 13:30:44,251 - core.ocr_queue - ERROR - Job ocr_F2_1758105037_f0acebfd permanently failed: OCR processing returned no result
2025-09-17 13:30:47,667 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:57 MSK)" (scheduled at 2025-09-17 13:30:47.654805+03:00)
2025-09-17 13:30:47,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:47,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:30:57 MSK)" executed successfully
2025-09-17 13:30:52,667 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:31:37 MSK)" (scheduled at 2025-09-17 13:30:52.653805+03:00)
2025-09-17 13:30:52,668 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:31:37 MSK)" executed successfully
2025-09-17 13:30:57,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:07 MSK)" (scheduled at 2025-09-17 13:30:57.654805+03:00)
2025-09-17 13:30:57,656 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:30:57,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:07 MSK)" executed successfully
2025-09-17 13:31:07,664 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:31:37 MSK)" (scheduled at 2025-09-17 13:31:07.651806+03:00)
2025-09-17 13:31:07,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:17 MSK)" (scheduled at 2025-09-17 13:31:07.654805+03:00)
2025-09-17 13:31:07,665 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:31:37 MSK)" executed successfully
2025-09-17 13:31:07,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:07,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:17 MSK)" executed successfully
2025-09-17 13:31:17,667 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:27 MSK)" (scheduled at 2025-09-17 13:31:17.654805+03:00)
2025-09-17 13:31:17,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:17,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:27 MSK)" executed successfully
2025-09-17 13:31:27,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:37 MSK)" (scheduled at 2025-09-17 13:31:27.654805+03:00)
2025-09-17 13:31:27,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:27,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:37 MSK)" executed successfully
2025-09-17 13:31:37,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:32:07 MSK)" (scheduled at 2025-09-17 13:31:37.651806+03:00)
2025-09-17 13:31:37,663 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:32:37 MSK)" (scheduled at 2025-09-17 13:31:37.652805+03:00)
2025-09-17 13:31:37,663 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:32:22 MSK)" (scheduled at 2025-09-17 13:31:37.653805+03:00)
2025-09-17 13:31:37,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:47 MSK)" (scheduled at 2025-09-17 13:31:37.654805+03:00)
2025-09-17 13:31:37,665 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:32:07 MSK)" executed successfully
2025-09-17 13:31:37,666 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:32:22 MSK)" executed successfully
2025-09-17 13:31:37,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:37,666 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:31:37,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:47 MSK)" executed successfully
2025-09-17 13:31:37,742 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133137_688_4d5352dd.jpg (700x1400) in 0.075s
2025-09-17 13:31:37,746 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:31:37,747 - core.database_manager - INFO - Created OCR session 7 for hotkey F2
2025-09-17 13:31:37,747 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105097_0135371c for F2 (session 7)
2025-09-17 13:31:37,747 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105097_0135371c (attempt 1)
2025-09-17 13:31:37,748 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:32:37 MSK)" executed successfully
2025-09-17 13:31:37,748 - core.ocr_client - INFO - Starting OCR request 27853334 for merged_20250917_133137_688_4d5352dd.jpg (0.1MB)
2025-09-17 13:31:37,749 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:31:37,838 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 27853334: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:31:37,839 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:31:37,875 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 27853334: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "16ddca74-89bd-4e5f-a713-42fa872ae407"
  }
 ]
}

2025-09-17 13:31:37,876 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:31:37,876 - core.ocr_queue - ERROR - Job ocr_F2_1758105097_0135371c failed on attempt 1: OCR processing returned no result
2025-09-17 13:31:37,877 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105097_0135371c for retry in 2s
2025-09-17 13:31:39,878 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105097_0135371c (attempt 2)
2025-09-17 13:31:39,878 - core.ocr_client - INFO - Starting OCR request 96e0cc9d for merged_20250917_133137_688_4d5352dd.jpg (0.1MB)
2025-09-17 13:31:39,879 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:31:39,945 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 96e0cc9d: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:31:39,946 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:31:39,984 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 96e0cc9d: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "4fad82e3-9492-435c-b313-a31399986d6e"
  }
 ]
}

2025-09-17 13:31:39,985 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:31:39,985 - core.ocr_queue - ERROR - Job ocr_F2_1758105097_0135371c failed on attempt 2: OCR processing returned no result
2025-09-17 13:31:39,985 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105097_0135371c for retry in 4s
2025-09-17 13:31:43,987 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105097_0135371c (attempt 3)
2025-09-17 13:31:43,987 - core.ocr_client - INFO - Starting OCR request 42eb0f7a for merged_20250917_133137_688_4d5352dd.jpg (0.1MB)
2025-09-17 13:31:43,988 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:31:44,110 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 42eb0f7a: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:31:44,111 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:31:44,201 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 42eb0f7a: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "b500575b-c833-4c0c-947b-6c7a4e3043d0"
  }
 ]
}

2025-09-17 13:31:44,202 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:31:44,202 - core.ocr_queue - ERROR - Job ocr_F2_1758105097_0135371c failed on attempt 3: OCR processing returned no result
2025-09-17 13:31:44,203 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105097_0135371c)
2025-09-17 13:31:44,203 - core.ocr_queue - ERROR - Job ocr_F2_1758105097_0135371c permanently failed: OCR processing returned no result
2025-09-17 13:31:47,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:57 MSK)" (scheduled at 2025-09-17 13:31:47.654805+03:00)
2025-09-17 13:31:47,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:47,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:31:57 MSK)" executed successfully
2025-09-17 13:31:57,658 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:07 MSK)" (scheduled at 2025-09-17 13:31:57.654805+03:00)
2025-09-17 13:31:57,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:31:57,659 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:07 MSK)" executed successfully
2025-09-17 13:32:07,664 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:32:37 MSK)" (scheduled at 2025-09-17 13:32:07.651806+03:00)
2025-09-17 13:32:07,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:17 MSK)" (scheduled at 2025-09-17 13:32:07.654805+03:00)
2025-09-17 13:32:07,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:07,665 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:32:37 MSK)" executed successfully
2025-09-17 13:32:07,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:17 MSK)" executed successfully
2025-09-17 13:32:17,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:27 MSK)" (scheduled at 2025-09-17 13:32:17.654805+03:00)
2025-09-17 13:32:17,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:17,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:27 MSK)" executed successfully
2025-09-17 13:32:22,662 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:33:07 MSK)" (scheduled at 2025-09-17 13:32:22.653805+03:00)
2025-09-17 13:32:22,663 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:33:07 MSK)" executed successfully
2025-09-17 13:32:27,670 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:37 MSK)" (scheduled at 2025-09-17 13:32:27.654805+03:00)
2025-09-17 13:32:27,671 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:27,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:37 MSK)" executed successfully
2025-09-17 13:32:37,654 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:33:07 MSK)" (scheduled at 2025-09-17 13:32:37.651806+03:00)
2025-09-17 13:32:37,654 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:33:37 MSK)" (scheduled at 2025-09-17 13:32:37.652805+03:00)
2025-09-17 13:32:37,655 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:33:07 MSK)" executed successfully
2025-09-17 13:32:37,656 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:32:37,670 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:47 MSK)" (scheduled at 2025-09-17 13:32:37.654805+03:00)
2025-09-17 13:32:37,671 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:37,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:47 MSK)" executed successfully
2025-09-17 13:32:37,736 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133237_676_f5d46850.jpg (700x1400) in 0.080s
2025-09-17 13:32:37,740 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:32:37,740 - core.database_manager - INFO - Created OCR session 8 for hotkey F2
2025-09-17 13:32:37,741 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105157_01c0dcb2 for F2 (session 8)
2025-09-17 13:32:37,741 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105157_01c0dcb2 (attempt 1)
2025-09-17 13:32:37,741 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:33:37 MSK)" executed successfully
2025-09-17 13:32:37,742 - core.ocr_client - INFO - Starting OCR request ee112e6f for merged_20250917_133237_676_f5d46850.jpg (0.1MB)
2025-09-17 13:32:37,742 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:32:37,840 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ee112e6f: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:32:37,841 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:32:37,879 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ee112e6f: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "bce208fe-b4f8-40ae-a190-2a136a91b91c"
  }
 ]
}

2025-09-17 13:32:37,880 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:32:37,881 - core.ocr_queue - ERROR - Job ocr_F2_1758105157_01c0dcb2 failed on attempt 1: OCR processing returned no result
2025-09-17 13:32:37,881 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105157_01c0dcb2 for retry in 2s
2025-09-17 13:32:39,882 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105157_01c0dcb2 (attempt 2)
2025-09-17 13:32:39,882 - core.ocr_client - INFO - Starting OCR request 5b2cefa1 for merged_20250917_133237_676_f5d46850.jpg (0.1MB)
2025-09-17 13:32:39,883 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:32:39,964 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 5b2cefa1: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:32:39,964 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:32:39,998 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 5b2cefa1: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "717ff93f-51f3-481a-a490-ea6b4171cc5b"
  }
 ]
}

2025-09-17 13:32:39,999 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:32:40,000 - core.ocr_queue - ERROR - Job ocr_F2_1758105157_01c0dcb2 failed on attempt 2: OCR processing returned no result
2025-09-17 13:32:40,000 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105157_01c0dcb2 for retry in 4s
2025-09-17 13:32:44,002 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105157_01c0dcb2 (attempt 3)
2025-09-17 13:32:44,003 - core.ocr_client - INFO - Starting OCR request 69918c90 for merged_20250917_133237_676_f5d46850.jpg (0.1MB)
2025-09-17 13:32:44,003 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:32:44,218 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 69918c90: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:32:44,218 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:32:44,265 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 69918c90: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "144af307-9043-4534-b186-0404b4ae5702"
  }
 ]
}

2025-09-17 13:32:44,266 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:32:44,266 - core.ocr_queue - ERROR - Job ocr_F2_1758105157_01c0dcb2 failed on attempt 3: OCR processing returned no result
2025-09-17 13:32:44,267 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105157_01c0dcb2)
2025-09-17 13:32:44,267 - core.ocr_queue - ERROR - Job ocr_F2_1758105157_01c0dcb2 permanently failed: OCR processing returned no result
2025-09-17 13:32:47,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:57 MSK)" (scheduled at 2025-09-17 13:32:47.654805+03:00)
2025-09-17 13:32:47,667 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:47,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:32:57 MSK)" executed successfully
2025-09-17 13:32:57,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:07 MSK)" (scheduled at 2025-09-17 13:32:57.654805+03:00)
2025-09-17 13:32:57,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:32:57,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:07 MSK)" executed successfully
2025-09-17 13:33:07,662 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:33:37 MSK)" (scheduled at 2025-09-17 13:33:07.651806+03:00)
2025-09-17 13:33:07,662 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:33:52 MSK)" (scheduled at 2025-09-17 13:33:07.653805+03:00)
2025-09-17 13:33:07,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:17 MSK)" (scheduled at 2025-09-17 13:33:07.654805+03:00)
2025-09-17 13:33:07,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:33:37 MSK)" executed successfully
2025-09-17 13:33:07,664 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:33:52 MSK)" executed successfully
2025-09-17 13:33:07,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:07,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:17 MSK)" executed successfully
2025-09-17 13:33:17,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:27 MSK)" (scheduled at 2025-09-17 13:33:17.654805+03:00)
2025-09-17 13:33:17,656 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:17,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:27 MSK)" executed successfully
2025-09-17 13:33:27,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:37 MSK)" (scheduled at 2025-09-17 13:33:27.654805+03:00)
2025-09-17 13:33:27,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:27,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:37 MSK)" executed successfully
2025-09-17 13:33:37,654 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:34:07 MSK)" (scheduled at 2025-09-17 13:33:37.651806+03:00)
2025-09-17 13:33:37,654 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:34:37 MSK)" (scheduled at 2025-09-17 13:33:37.652805+03:00)
2025-09-17 13:33:37,655 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:34:07 MSK)" executed successfully
2025-09-17 13:33:37,656 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:33:37,670 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:47 MSK)" (scheduled at 2025-09-17 13:33:37.654805+03:00)
2025-09-17 13:33:37,671 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:37,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:47 MSK)" executed successfully
2025-09-17 13:33:37,734 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133337_677_a423a0e8.jpg (700x1400) in 0.078s
2025-09-17 13:33:37,738 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:33:37,738 - core.database_manager - INFO - Created OCR session 9 for hotkey F2
2025-09-17 13:33:37,739 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105217_1e4928e1 for F2 (session 9)
2025-09-17 13:33:37,739 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105217_1e4928e1 (attempt 1)
2025-09-17 13:33:37,739 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:34:37 MSK)" executed successfully
2025-09-17 13:33:37,740 - core.ocr_client - INFO - Starting OCR request 2110cfa9 for merged_20250917_133337_677_a423a0e8.jpg (0.1MB)
2025-09-17 13:33:37,740 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:33:37,825 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 2110cfa9: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:33:37,826 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:33:37,863 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 2110cfa9: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "08d409c8-b5a9-401f-831a-49c936879211"
  }
 ]
}

2025-09-17 13:33:37,864 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:33:37,864 - core.ocr_queue - ERROR - Job ocr_F2_1758105217_1e4928e1 failed on attempt 1: OCR processing returned no result
2025-09-17 13:33:37,865 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105217_1e4928e1 for retry in 2s
2025-09-17 13:33:39,867 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105217_1e4928e1 (attempt 2)
2025-09-17 13:33:39,868 - core.ocr_client - INFO - Starting OCR request 194ca849 for merged_20250917_133337_677_a423a0e8.jpg (0.1MB)
2025-09-17 13:33:39,868 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:33:39,934 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 194ca849: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:33:39,935 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:33:39,971 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 194ca849: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "b92e3266-e354-43c1-96e3-28951552cec0"
  }
 ]
}

2025-09-17 13:33:39,972 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:33:39,973 - core.ocr_queue - ERROR - Job ocr_F2_1758105217_1e4928e1 failed on attempt 2: OCR processing returned no result
2025-09-17 13:33:39,973 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105217_1e4928e1 for retry in 4s
2025-09-17 13:33:43,975 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105217_1e4928e1 (attempt 3)
2025-09-17 13:33:43,975 - core.ocr_client - INFO - Starting OCR request 00fbbf52 for merged_20250917_133337_677_a423a0e8.jpg (0.1MB)
2025-09-17 13:33:43,976 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:33:44,151 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 00fbbf52: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:33:44,151 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:33:44,225 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 00fbbf52: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "89c1f314-9cc4-49fe-b0c0-1f4e0f43e8a5"
  }
 ]
}

2025-09-17 13:33:44,226 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:33:44,226 - core.ocr_queue - ERROR - Job ocr_F2_1758105217_1e4928e1 failed on attempt 3: OCR processing returned no result
2025-09-17 13:33:44,227 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105217_1e4928e1)
2025-09-17 13:33:44,227 - core.ocr_queue - ERROR - Job ocr_F2_1758105217_1e4928e1 permanently failed: OCR processing returned no result
2025-09-17 13:33:47,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:57 MSK)" (scheduled at 2025-09-17 13:33:47.654805+03:00)
2025-09-17 13:33:47,667 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:47,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:33:57 MSK)" executed successfully
2025-09-17 13:33:52,658 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:34:37 MSK)" (scheduled at 2025-09-17 13:33:52.653805+03:00)
2025-09-17 13:33:52,659 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:34:37 MSK)" executed successfully
2025-09-17 13:33:57,658 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:07 MSK)" (scheduled at 2025-09-17 13:33:57.654805+03:00)
2025-09-17 13:33:57,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:33:57,659 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:07 MSK)" executed successfully
2025-09-17 13:34:07,654 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:34:37 MSK)" (scheduled at 2025-09-17 13:34:07.651806+03:00)
2025-09-17 13:34:07,654 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:17 MSK)" (scheduled at 2025-09-17 13:34:07.654805+03:00)
2025-09-17 13:34:07,655 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:34:37 MSK)" executed successfully
2025-09-17 13:34:07,655 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:07,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:17 MSK)" executed successfully
2025-09-17 13:34:17,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:27 MSK)" (scheduled at 2025-09-17 13:34:17.654805+03:00)
2025-09-17 13:34:17,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:17,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:27 MSK)" executed successfully
2025-09-17 13:34:27,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:37 MSK)" (scheduled at 2025-09-17 13:34:27.654805+03:00)
2025-09-17 13:34:27,656 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:27,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:37 MSK)" executed successfully
2025-09-17 13:34:37,666 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:35:07 MSK)" (scheduled at 2025-09-17 13:34:37.651806+03:00)
2025-09-17 13:34:37,666 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:35:37 MSK)" (scheduled at 2025-09-17 13:34:37.652805+03:00)
2025-09-17 13:34:37,666 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:35:22 MSK)" (scheduled at 2025-09-17 13:34:37.653805+03:00)
2025-09-17 13:34:37,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:47 MSK)" (scheduled at 2025-09-17 13:34:37.654805+03:00)
2025-09-17 13:34:37,668 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:35:07 MSK)" executed successfully
2025-09-17 13:34:37,668 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:34:37,668 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:35:22 MSK)" executed successfully
2025-09-17 13:34:37,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:37,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:47 MSK)" executed successfully
2025-09-17 13:34:37,744 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133437_690_cc01123d.jpg (700x1400) in 0.076s
2025-09-17 13:34:37,748 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:34:37,749 - core.database_manager - INFO - Created OCR session 10 for hotkey F2
2025-09-17 13:34:37,750 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105277_e9d4ed86 for F2 (session 10)
2025-09-17 13:34:37,750 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105277_e9d4ed86 (attempt 1)
2025-09-17 13:34:37,750 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:35:37 MSK)" executed successfully
2025-09-17 13:34:37,750 - core.ocr_client - INFO - Starting OCR request b70920c3 for merged_20250917_133437_690_cc01123d.jpg (0.1MB)
2025-09-17 13:34:37,751 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:34:37,827 - core.ocr_client - ERROR - Non-retryable error for primary-ocr b70920c3: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:34:37,827 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:34:37,871 - core.ocr_client - ERROR - Non-retryable error for fallback-vision b70920c3: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "b1e91a3e-5ba1-4bf4-97e1-b677a566769c"
  }
 ]
}

2025-09-17 13:34:37,872 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:34:37,872 - core.ocr_queue - ERROR - Job ocr_F2_1758105277_e9d4ed86 failed on attempt 1: OCR processing returned no result
2025-09-17 13:34:37,872 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105277_e9d4ed86 for retry in 2s
2025-09-17 13:34:39,874 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105277_e9d4ed86 (attempt 2)
2025-09-17 13:34:39,874 - core.ocr_client - INFO - Starting OCR request 2e33fdb9 for merged_20250917_133437_690_cc01123d.jpg (0.1MB)
2025-09-17 13:34:39,874 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:34:39,942 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 2e33fdb9: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:34:39,943 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:34:39,985 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 2e33fdb9: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "e915249a-8d8f-4b37-bacc-8fc195ef0eaa"
  }
 ]
}

2025-09-17 13:34:39,986 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:34:39,987 - core.ocr_queue - ERROR - Job ocr_F2_1758105277_e9d4ed86 failed on attempt 2: OCR processing returned no result
2025-09-17 13:34:39,987 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105277_e9d4ed86 for retry in 4s
2025-09-17 13:34:43,988 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105277_e9d4ed86 (attempt 3)
2025-09-17 13:34:43,988 - core.ocr_client - INFO - Starting OCR request eb6ff400 for merged_20250917_133437_690_cc01123d.jpg (0.1MB)
2025-09-17 13:34:43,989 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:34:44,105 - core.ocr_client - ERROR - Non-retryable error for primary-ocr eb6ff400: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:34:44,105 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:34:44,179 - core.ocr_client - ERROR - Non-retryable error for fallback-vision eb6ff400: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "407e8a46-a13b-4935-a252-67b92a79814a"
  }
 ]
}

2025-09-17 13:34:44,180 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:34:44,180 - core.ocr_queue - ERROR - Job ocr_F2_1758105277_e9d4ed86 failed on attempt 3: OCR processing returned no result
2025-09-17 13:34:44,181 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105277_e9d4ed86)
2025-09-17 13:34:44,181 - core.ocr_queue - ERROR - Job ocr_F2_1758105277_e9d4ed86 permanently failed: OCR processing returned no result
2025-09-17 13:34:47,656 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:57 MSK)" (scheduled at 2025-09-17 13:34:47.654805+03:00)
2025-09-17 13:34:47,657 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:47,657 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:34:57 MSK)" executed successfully
2025-09-17 13:34:57,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:07 MSK)" (scheduled at 2025-09-17 13:34:57.654805+03:00)
2025-09-17 13:34:57,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:34:57,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:07 MSK)" executed successfully
2025-09-17 13:35:00,964 - main - WARNING - Monitoring engine health issues: ['No items in monitoring queue']
2025-09-17 13:35:00,964 - main - WARNING - Periodic health check failed: 'int' object has no attribute 'name'
2025-09-17 13:35:07,653 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:35:37 MSK)" (scheduled at 2025-09-17 13:35:07.651806+03:00)
2025-09-17 13:35:07,654 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:35:37 MSK)" executed successfully
2025-09-17 13:35:07,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:17 MSK)" (scheduled at 2025-09-17 13:35:07.654805+03:00)
2025-09-17 13:35:07,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:07,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:17 MSK)" executed successfully
2025-09-17 13:35:17,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:27 MSK)" (scheduled at 2025-09-17 13:35:17.654805+03:00)
2025-09-17 13:35:17,667 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:17,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:27 MSK)" executed successfully
2025-09-17 13:35:22,654 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:36:07 MSK)" (scheduled at 2025-09-17 13:35:22.653805+03:00)
2025-09-17 13:35:22,655 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:36:07 MSK)" executed successfully
2025-09-17 13:35:27,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:37 MSK)" (scheduled at 2025-09-17 13:35:27.654805+03:00)
2025-09-17 13:35:27,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:27,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:37 MSK)" executed successfully
2025-09-17 13:35:37,657 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:36:07 MSK)" (scheduled at 2025-09-17 13:35:37.651806+03:00)
2025-09-17 13:35:37,657 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:36:37 MSK)" (scheduled at 2025-09-17 13:35:37.652805+03:00)
2025-09-17 13:35:37,657 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:47 MSK)" (scheduled at 2025-09-17 13:35:37.654805+03:00)
2025-09-17 13:35:37,658 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:36:07 MSK)" executed successfully
2025-09-17 13:35:37,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:37,659 - core.image_processor - INFO - Processing 3 screenshots for F2
2025-09-17 13:35:37,659 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:47 MSK)" executed successfully
2025-09-17 13:35:37,734 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133537_682_cc63a6a4.jpg (700x1400) in 0.074s
2025-09-17 13:35:37,738 - core.image_processor - INFO - Cleaned up source files: 3 successful, 0 failed
2025-09-17 13:35:37,739 - core.database_manager - INFO - Created OCR session 11 for hotkey F2
2025-09-17 13:35:37,740 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105337_b405a46d for F2 (session 11)
2025-09-17 13:35:37,740 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105337_b405a46d (attempt 1)
2025-09-17 13:35:37,740 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:36:37 MSK)" executed successfully
2025-09-17 13:35:37,740 - core.ocr_client - INFO - Starting OCR request 76d8ebb3 for merged_20250917_133537_682_cc63a6a4.jpg (0.1MB)
2025-09-17 13:35:37,741 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:35:37,821 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 76d8ebb3: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:35:37,822 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:35:37,864 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 76d8ebb3: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "36808f3c-7584-496d-9d10-ede86c649869"
  }
 ]
}

2025-09-17 13:35:37,865 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:35:37,866 - core.ocr_queue - ERROR - Job ocr_F2_1758105337_b405a46d failed on attempt 1: OCR processing returned no result
2025-09-17 13:35:37,866 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105337_b405a46d for retry in 2s
2025-09-17 13:35:39,867 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105337_b405a46d (attempt 2)
2025-09-17 13:35:39,867 - core.ocr_client - INFO - Starting OCR request 3f2c2b1c for merged_20250917_133537_682_cc63a6a4.jpg (0.1MB)
2025-09-17 13:35:39,868 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:35:39,941 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 3f2c2b1c: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:35:39,941 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:35:39,985 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 3f2c2b1c: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "be07cb9c-12f6-498e-a4cd-052aea99465e"
  }
 ]
}

2025-09-17 13:35:39,986 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:35:39,986 - core.ocr_queue - ERROR - Job ocr_F2_1758105337_b405a46d failed on attempt 2: OCR processing returned no result
2025-09-17 13:35:39,987 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105337_b405a46d for retry in 4s
2025-09-17 13:35:43,988 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105337_b405a46d (attempt 3)
2025-09-17 13:35:43,988 - core.ocr_client - INFO - Starting OCR request e4867d46 for merged_20250917_133537_682_cc63a6a4.jpg (0.1MB)
2025-09-17 13:35:43,989 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:35:44,086 - core.ocr_client - ERROR - Non-retryable error for primary-ocr e4867d46: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:35:44,087 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:35:44,195 - core.ocr_client - ERROR - Non-retryable error for fallback-vision e4867d46: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "ede6a12b-8430-4b9d-821f-305f41d4d73b"
  }
 ]
}

2025-09-17 13:35:44,196 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:35:44,196 - core.ocr_queue - ERROR - Job ocr_F2_1758105337_b405a46d failed on attempt 3: OCR processing returned no result
2025-09-17 13:35:44,196 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105337_b405a46d)
2025-09-17 13:35:44,197 - core.ocr_queue - ERROR - Job ocr_F2_1758105337_b405a46d permanently failed: OCR processing returned no result
2025-09-17 13:35:47,657 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:57 MSK)" (scheduled at 2025-09-17 13:35:47.654805+03:00)
2025-09-17 13:35:47,658 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:47,658 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:35:57 MSK)" executed successfully
2025-09-17 13:35:57,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:07 MSK)" (scheduled at 2025-09-17 13:35:57.654805+03:00)
2025-09-17 13:35:57,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:35:57,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:07 MSK)" executed successfully
2025-09-17 13:36:07,662 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:36:37 MSK)" (scheduled at 2025-09-17 13:36:07.651806+03:00)
2025-09-17 13:36:07,662 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:36:52 MSK)" (scheduled at 2025-09-17 13:36:07.653805+03:00)
2025-09-17 13:36:07,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:17 MSK)" (scheduled at 2025-09-17 13:36:07.654805+03:00)
2025-09-17 13:36:07,663 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:36:37 MSK)" executed successfully
2025-09-17 13:36:07,679 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:36:52 MSK)" executed successfully
2025-09-17 13:36:07,679 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:07,680 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:17 MSK)" executed successfully
2025-09-17 13:36:17,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:27 MSK)" (scheduled at 2025-09-17 13:36:17.654805+03:00)
2025-09-17 13:36:17,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:17,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:27 MSK)" executed successfully
2025-09-17 13:36:27,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:37 MSK)" (scheduled at 2025-09-17 13:36:27.654805+03:00)
2025-09-17 13:36:27,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:27,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:37 MSK)" executed successfully
2025-09-17 13:36:31,973 - core.screenshot_capture - INFO - Hotkey F2 pressed - capturing screenshot
2025-09-17 13:36:32,260 - core.screenshot_capture - INFO - Screenshot captured successfully: F2_20250917_133631_974_1b34df92.png (285x400) in 0.287s
2025-09-17 13:36:37,666 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:37:07 MSK)" (scheduled at 2025-09-17 13:36:37.651806+03:00)
2025-09-17 13:36:37,666 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:37:37 MSK)" (scheduled at 2025-09-17 13:36:37.652805+03:00)
2025-09-17 13:36:37,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:47 MSK)" (scheduled at 2025-09-17 13:36:37.654805+03:00)
2025-09-17 13:36:37,667 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:37:07 MSK)" executed successfully
2025-09-17 13:36:37,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:37,668 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:36:37,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:47 MSK)" executed successfully
2025-09-17 13:36:37,758 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133637_694_92e34415.jpg (700x1800) in 0.088s
2025-09-17 13:36:37,763 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:36:37,763 - core.database_manager - INFO - Created OCR session 12 for hotkey F2
2025-09-17 13:36:37,764 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105397_dd521ed6 for F2 (session 12)
2025-09-17 13:36:37,764 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105397_dd521ed6 (attempt 1)
2025-09-17 13:36:37,764 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:37:37 MSK)" executed successfully
2025-09-17 13:36:37,765 - core.ocr_client - INFO - Starting OCR request ca6224e5 for merged_20250917_133637_694_92e34415.jpg (0.2MB)
2025-09-17 13:36:37,765 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:36:37,872 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ca6224e5: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:36:37,873 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:36:37,956 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ca6224e5: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "2ca52cc6-1082-49c3-b354-34565be0166e"
  }
 ]
}

2025-09-17 13:36:37,957 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:36:37,958 - core.ocr_queue - ERROR - Job ocr_F2_1758105397_dd521ed6 failed on attempt 1: OCR processing returned no result
2025-09-17 13:36:37,958 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105397_dd521ed6 for retry in 2s
2025-09-17 13:36:39,959 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105397_dd521ed6 (attempt 2)
2025-09-17 13:36:39,959 - core.ocr_client - INFO - Starting OCR request b9ad6594 for merged_20250917_133637_694_92e34415.jpg (0.2MB)
2025-09-17 13:36:39,960 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:36:40,045 - core.ocr_client - ERROR - Non-retryable error for primary-ocr b9ad6594: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:36:40,046 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:36:40,124 - core.ocr_client - ERROR - Non-retryable error for fallback-vision b9ad6594: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "25128381-0bc6-42a5-aca4-63e42475b121"
  }
 ]
}

2025-09-17 13:36:40,125 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:36:40,126 - core.ocr_queue - ERROR - Job ocr_F2_1758105397_dd521ed6 failed on attempt 2: OCR processing returned no result
2025-09-17 13:36:40,126 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105397_dd521ed6 for retry in 4s
2025-09-17 13:36:44,127 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105397_dd521ed6 (attempt 3)
2025-09-17 13:36:44,127 - core.ocr_client - INFO - Starting OCR request aaffb45a for merged_20250917_133637_694_92e34415.jpg (0.2MB)
2025-09-17 13:36:44,128 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:36:44,590 - core.ocr_client - ERROR - Non-retryable error for primary-ocr aaffb45a: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:36:44,590 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:36:44,670 - core.ocr_client - ERROR - Non-retryable error for fallback-vision aaffb45a: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "a2d76b3d-71b1-43b7-ac69-51f6522be57c"
  }
 ]
}

2025-09-17 13:36:44,671 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:36:44,671 - core.ocr_queue - ERROR - Job ocr_F2_1758105397_dd521ed6 failed on attempt 3: OCR processing returned no result
2025-09-17 13:36:44,672 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105397_dd521ed6)
2025-09-17 13:36:44,672 - core.ocr_queue - ERROR - Job ocr_F2_1758105397_dd521ed6 permanently failed: OCR processing returned no result
2025-09-17 13:36:47,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:57 MSK)" (scheduled at 2025-09-17 13:36:47.654805+03:00)
2025-09-17 13:36:47,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:47,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:36:57 MSK)" executed successfully
2025-09-17 13:36:52,655 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:37:37 MSK)" (scheduled at 2025-09-17 13:36:52.653805+03:00)
2025-09-17 13:36:52,656 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:37:37 MSK)" executed successfully
2025-09-17 13:36:57,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:07 MSK)" (scheduled at 2025-09-17 13:36:57.654805+03:00)
2025-09-17 13:36:57,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:36:57,662 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:07 MSK)" executed successfully
2025-09-17 13:37:07,659 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:37:37 MSK)" (scheduled at 2025-09-17 13:37:07.651806+03:00)
2025-09-17 13:37:07,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:17 MSK)" (scheduled at 2025-09-17 13:37:07.654805+03:00)
2025-09-17 13:37:07,660 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:37:37 MSK)" executed successfully
2025-09-17 13:37:07,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:07,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:17 MSK)" executed successfully
2025-09-17 13:37:17,657 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:27 MSK)" (scheduled at 2025-09-17 13:37:17.654805+03:00)
2025-09-17 13:37:17,658 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:17,658 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:27 MSK)" executed successfully
2025-09-17 13:37:27,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:37 MSK)" (scheduled at 2025-09-17 13:37:27.654805+03:00)
2025-09-17 13:37:27,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:27,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:37 MSK)" executed successfully
2025-09-17 13:37:37,666 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:38:07 MSK)" (scheduled at 2025-09-17 13:37:37.651806+03:00)
2025-09-17 13:37:37,666 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:38:37 MSK)" (scheduled at 2025-09-17 13:37:37.652805+03:00)
2025-09-17 13:37:37,666 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:38:22 MSK)" (scheduled at 2025-09-17 13:37:37.653805+03:00)
2025-09-17 13:37:37,666 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:47 MSK)" (scheduled at 2025-09-17 13:37:37.654805+03:00)
2025-09-17 13:37:37,668 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:38:07 MSK)" executed successfully
2025-09-17 13:37:37,668 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:38:22 MSK)" executed successfully
2025-09-17 13:37:37,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:37,668 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:37:37,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:47 MSK)" executed successfully
2025-09-17 13:37:37,775 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133737_696_3821e9cd.jpg (700x1800) in 0.106s
2025-09-17 13:37:37,780 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:37:37,780 - core.database_manager - INFO - Created OCR session 13 for hotkey F2
2025-09-17 13:37:37,781 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105457_323642cf for F2 (session 13)
2025-09-17 13:37:37,781 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105457_323642cf (attempt 1)
2025-09-17 13:37:37,781 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:38:37 MSK)" executed successfully
2025-09-17 13:37:37,782 - core.ocr_client - INFO - Starting OCR request 55afa728 for merged_20250917_133737_696_3821e9cd.jpg (0.2MB)
2025-09-17 13:37:37,782 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:37:37,879 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 55afa728: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:37:37,880 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:37:37,986 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 55afa728: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "dbbc3fe5-d4e3-46f1-9336-59dd46d37d29"
  }
 ]
}

2025-09-17 13:37:37,986 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:37:37,987 - core.ocr_queue - ERROR - Job ocr_F2_1758105457_323642cf failed on attempt 1: OCR processing returned no result
2025-09-17 13:37:37,987 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105457_323642cf for retry in 2s
2025-09-17 13:37:39,988 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105457_323642cf (attempt 2)
2025-09-17 13:37:39,988 - core.ocr_client - INFO - Starting OCR request 6ee2a3a4 for merged_20250917_133737_696_3821e9cd.jpg (0.2MB)
2025-09-17 13:37:39,989 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:37:40,085 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 6ee2a3a4: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:37:40,085 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:37:40,168 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 6ee2a3a4: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "bb0f2344-1b37-4eb8-8f40-4a70bce23fb1"
  }
 ]
}

2025-09-17 13:37:40,169 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:37:40,169 - core.ocr_queue - ERROR - Job ocr_F2_1758105457_323642cf failed on attempt 2: OCR processing returned no result
2025-09-17 13:37:40,170 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105457_323642cf for retry in 4s
2025-09-17 13:37:44,171 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105457_323642cf (attempt 3)
2025-09-17 13:37:44,171 - core.ocr_client - INFO - Starting OCR request 4e43c2ac for merged_20250917_133737_696_3821e9cd.jpg (0.2MB)
2025-09-17 13:37:44,172 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:37:44,309 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 4e43c2ac: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:37:44,310 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:37:44,425 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 4e43c2ac: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "c0bb85bc-0460-4759-8905-c8f960b2ab87"
  }
 ]
}

2025-09-17 13:37:44,426 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:37:44,427 - core.ocr_queue - ERROR - Job ocr_F2_1758105457_323642cf failed on attempt 3: OCR processing returned no result
2025-09-17 13:37:44,427 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105457_323642cf)
2025-09-17 13:37:44,428 - core.ocr_queue - ERROR - Job ocr_F2_1758105457_323642cf permanently failed: OCR processing returned no result
2025-09-17 13:37:47,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:57 MSK)" (scheduled at 2025-09-17 13:37:47.654805+03:00)
2025-09-17 13:37:47,656 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:47,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:37:57 MSK)" executed successfully
2025-09-17 13:37:57,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:07 MSK)" (scheduled at 2025-09-17 13:37:57.654805+03:00)
2025-09-17 13:37:57,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:37:57,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:07 MSK)" executed successfully
2025-09-17 13:38:07,653 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:38:37 MSK)" (scheduled at 2025-09-17 13:38:07.651806+03:00)
2025-09-17 13:38:07,654 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:38:37 MSK)" executed successfully
2025-09-17 13:38:07,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:17 MSK)" (scheduled at 2025-09-17 13:38:07.654805+03:00)
2025-09-17 13:38:07,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:07,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:17 MSK)" executed successfully
2025-09-17 13:38:17,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:27 MSK)" (scheduled at 2025-09-17 13:38:17.654805+03:00)
2025-09-17 13:38:17,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:17,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:27 MSK)" executed successfully
2025-09-17 13:38:22,668 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:39:07 MSK)" (scheduled at 2025-09-17 13:38:22.653805+03:00)
2025-09-17 13:38:22,669 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:39:07 MSK)" executed successfully
2025-09-17 13:38:27,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:37 MSK)" (scheduled at 2025-09-17 13:38:27.654805+03:00)
2025-09-17 13:38:27,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:27,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:37 MSK)" executed successfully
2025-09-17 13:38:37,660 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:39:07 MSK)" (scheduled at 2025-09-17 13:38:37.651806+03:00)
2025-09-17 13:38:37,660 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:39:37 MSK)" (scheduled at 2025-09-17 13:38:37.652805+03:00)
2025-09-17 13:38:37,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:47 MSK)" (scheduled at 2025-09-17 13:38:37.654805+03:00)
2025-09-17 13:38:37,661 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:39:07 MSK)" executed successfully
2025-09-17 13:38:37,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:37,662 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:38:37,662 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:47 MSK)" executed successfully
2025-09-17 13:38:37,756 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133837_690_6ce204c7.jpg (700x1800) in 0.093s
2025-09-17 13:38:37,761 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:38:37,761 - core.database_manager - INFO - Created OCR session 14 for hotkey F2
2025-09-17 13:38:37,762 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105517_20fea532 for F2 (session 14)
2025-09-17 13:38:37,762 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105517_20fea532 (attempt 1)
2025-09-17 13:38:37,763 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:39:37 MSK)" executed successfully
2025-09-17 13:38:37,763 - core.ocr_client - INFO - Starting OCR request 68a2d097 for merged_20250917_133837_690_6ce204c7.jpg (0.2MB)
2025-09-17 13:38:37,764 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:38:37,887 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 68a2d097: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:38:37,888 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:38:37,959 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 68a2d097: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "6fad078a-a857-4a1a-9f89-52abcf15b568"
  }
 ]
}

2025-09-17 13:38:37,960 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:38:37,960 - core.ocr_queue - ERROR - Job ocr_F2_1758105517_20fea532 failed on attempt 1: OCR processing returned no result
2025-09-17 13:38:37,961 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105517_20fea532 for retry in 2s
2025-09-17 13:38:39,963 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105517_20fea532 (attempt 2)
2025-09-17 13:38:39,963 - core.ocr_client - INFO - Starting OCR request 9e673673 for merged_20250917_133837_690_6ce204c7.jpg (0.2MB)
2025-09-17 13:38:39,964 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:38:40,060 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 9e673673: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:38:40,061 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:38:40,143 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 9e673673: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "8abeb033-da63-45e7-8ded-6444535e18f8"
  }
 ]
}

2025-09-17 13:38:40,144 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:38:40,144 - core.ocr_queue - ERROR - Job ocr_F2_1758105517_20fea532 failed on attempt 2: OCR processing returned no result
2025-09-17 13:38:40,145 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105517_20fea532 for retry in 4s
2025-09-17 13:38:44,146 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105517_20fea532 (attempt 3)
2025-09-17 13:38:44,146 - core.ocr_client - INFO - Starting OCR request 0d06c0af for merged_20250917_133837_690_6ce204c7.jpg (0.2MB)
2025-09-17 13:38:44,147 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:38:44,259 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 0d06c0af: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:38:44,260 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:38:44,374 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 0d06c0af: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "d0680263-bf8c-47a4-8688-aa11b957ca31"
  }
 ]
}

2025-09-17 13:38:44,375 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:38:44,376 - core.ocr_queue - ERROR - Job ocr_F2_1758105517_20fea532 failed on attempt 3: OCR processing returned no result
2025-09-17 13:38:44,376 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105517_20fea532)
2025-09-17 13:38:44,377 - core.ocr_queue - ERROR - Job ocr_F2_1758105517_20fea532 permanently failed: OCR processing returned no result
2025-09-17 13:38:47,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:57 MSK)" (scheduled at 2025-09-17 13:38:47.654805+03:00)
2025-09-17 13:38:47,656 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:47,656 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:38:57 MSK)" executed successfully
2025-09-17 13:38:57,658 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:07 MSK)" (scheduled at 2025-09-17 13:38:57.654805+03:00)
2025-09-17 13:38:57,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:38:57,659 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:07 MSK)" executed successfully
2025-09-17 13:39:07,664 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:39:37 MSK)" (scheduled at 2025-09-17 13:39:07.651806+03:00)
2025-09-17 13:39:07,664 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:39:52 MSK)" (scheduled at 2025-09-17 13:39:07.653805+03:00)
2025-09-17 13:39:07,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:17 MSK)" (scheduled at 2025-09-17 13:39:07.654805+03:00)
2025-09-17 13:39:07,666 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:39:37 MSK)" executed successfully
2025-09-17 13:39:07,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:07,666 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:39:52 MSK)" executed successfully
2025-09-17 13:39:07,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:17 MSK)" executed successfully
2025-09-17 13:39:17,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:27 MSK)" (scheduled at 2025-09-17 13:39:17.654805+03:00)
2025-09-17 13:39:17,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:17,669 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:27 MSK)" executed successfully
2025-09-17 13:39:27,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:37 MSK)" (scheduled at 2025-09-17 13:39:27.654805+03:00)
2025-09-17 13:39:27,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:27,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:37 MSK)" executed successfully
2025-09-17 13:39:37,652 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:40:07 MSK)" (scheduled at 2025-09-17 13:39:37.651806+03:00)
2025-09-17 13:39:37,653 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:40:07 MSK)" executed successfully
2025-09-17 13:39:37,668 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:40:37 MSK)" (scheduled at 2025-09-17 13:39:37.652805+03:00)
2025-09-17 13:39:37,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:47 MSK)" (scheduled at 2025-09-17 13:39:37.654805+03:00)
2025-09-17 13:39:37,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:37,670 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:39:37,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:47 MSK)" executed successfully
2025-09-17 13:39:37,969 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_133937_885_245d2b1c.jpg (700x1800) in 0.299s
2025-09-17 13:39:37,974 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:39:37,975 - core.database_manager - INFO - Created OCR session 15 for hotkey F2
2025-09-17 13:39:37,976 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105577_5f00bb4d for F2 (session 15)
2025-09-17 13:39:37,976 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105577_5f00bb4d (attempt 1)
2025-09-17 13:39:37,976 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:40:37 MSK)" executed successfully
2025-09-17 13:39:37,977 - core.ocr_client - INFO - Starting OCR request 745b421c for merged_20250917_133937_885_245d2b1c.jpg (0.2MB)
2025-09-17 13:39:37,977 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:39:38,806 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 745b421c: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:39:38,806 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:39:39,623 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 745b421c: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "b1304e66-a4cb-4b9e-b0ae-efb98e5183fd"
  }
 ]
}

2025-09-17 13:39:39,623 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:39:39,624 - core.ocr_queue - ERROR - Job ocr_F2_1758105577_5f00bb4d failed on attempt 1: OCR processing returned no result
2025-09-17 13:39:39,624 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105577_5f00bb4d for retry in 2s
2025-09-17 13:39:41,625 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105577_5f00bb4d (attempt 2)
2025-09-17 13:39:41,626 - core.ocr_client - INFO - Starting OCR request 73adff72 for merged_20250917_133937_885_245d2b1c.jpg (0.2MB)
2025-09-17 13:39:41,705 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:39:41,845 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 73adff72: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:39:41,846 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:39:42,008 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 73adff72: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "bd7e1b28-e142-48de-b935-46e50f93993a"
  }
 ]
}

2025-09-17 13:39:42,008 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:39:42,008 - core.ocr_queue - ERROR - Job ocr_F2_1758105577_5f00bb4d failed on attempt 2: OCR processing returned no result
2025-09-17 13:39:42,009 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105577_5f00bb4d for retry in 4s
2025-09-17 13:39:46,011 - core.ocr_queue - INFO - Worker OCRWorker-2 processing job ocr_F2_1758105577_5f00bb4d (attempt 3)
2025-09-17 13:39:46,011 - core.ocr_client - INFO - Starting OCR request abd28407 for merged_20250917_133937_885_245d2b1c.jpg (0.2MB)
2025-09-17 13:39:46,012 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:39:46,111 - core.ocr_client - ERROR - Non-retryable error for primary-ocr abd28407: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:39:46,112 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:39:46,208 - core.ocr_client - ERROR - Non-retryable error for fallback-vision abd28407: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "5af9205a-cbe9-4a21-9ca2-8f5b55fbb8a6"
  }
 ]
}

2025-09-17 13:39:46,209 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:39:46,210 - core.ocr_queue - ERROR - Job ocr_F2_1758105577_5f00bb4d failed on attempt 3: OCR processing returned no result
2025-09-17 13:39:46,210 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105577_5f00bb4d)
2025-09-17 13:39:46,211 - core.ocr_queue - ERROR - Job ocr_F2_1758105577_5f00bb4d permanently failed: OCR processing returned no result
2025-09-17 13:39:47,667 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:57 MSK)" (scheduled at 2025-09-17 13:39:47.654805+03:00)
2025-09-17 13:39:47,668 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:47,668 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:39:57 MSK)" executed successfully
2025-09-17 13:39:52,665 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:40:37 MSK)" (scheduled at 2025-09-17 13:39:52.653805+03:00)
2025-09-17 13:39:52,666 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:40:37 MSK)" executed successfully
2025-09-17 13:39:57,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:07 MSK)" (scheduled at 2025-09-17 13:39:57.654805+03:00)
2025-09-17 13:39:57,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:39:57,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:07 MSK)" executed successfully
2025-09-17 13:40:00,116 - main - WARNING - Monitoring engine health issues: ['No items in monitoring queue']
2025-09-17 13:40:00,116 - main - WARNING - Periodic health check failed: 'int' object has no attribute 'name'
2025-09-17 13:40:07,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:40:37 MSK)" (scheduled at 2025-09-17 13:40:07.651806+03:00)
2025-09-17 13:40:07,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:17 MSK)" (scheduled at 2025-09-17 13:40:07.654805+03:00)
2025-09-17 13:40:07,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:07,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:40:37 MSK)" executed successfully
2025-09-17 13:40:07,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:17 MSK)" executed successfully
2025-09-17 13:40:17,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:27 MSK)" (scheduled at 2025-09-17 13:40:17.654805+03:00)
2025-09-17 13:40:17,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:17,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:27 MSK)" executed successfully
2025-09-17 13:40:27,670 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:37 MSK)" (scheduled at 2025-09-17 13:40:27.654805+03:00)
2025-09-17 13:40:27,671 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:27,671 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:37 MSK)" executed successfully
2025-09-17 13:40:37,653 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:41:07 MSK)" (scheduled at 2025-09-17 13:40:37.651806+03:00)
2025-09-17 13:40:37,653 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:41:37 MSK)" (scheduled at 2025-09-17 13:40:37.652805+03:00)
2025-09-17 13:40:37,654 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:41:07 MSK)" executed successfully
2025-09-17 13:40:37,655 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:40:37,668 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:41:22 MSK)" (scheduled at 2025-09-17 13:40:37.653805+03:00)
2025-09-17 13:40:37,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:47 MSK)" (scheduled at 2025-09-17 13:40:37.654805+03:00)
2025-09-17 13:40:37,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:37,670 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:41:22 MSK)" executed successfully
2025-09-17 13:40:37,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:47 MSK)" executed successfully
2025-09-17 13:40:37,747 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_134037_682_25f5ad5c.jpg (700x1800) in 0.091s
2025-09-17 13:40:37,752 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:40:37,753 - core.database_manager - INFO - Created OCR session 16 for hotkey F2
2025-09-17 13:40:37,753 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105637_76669139 for F2 (session 16)
2025-09-17 13:40:37,753 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105637_76669139 (attempt 1)
2025-09-17 13:40:37,754 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:41:37 MSK)" executed successfully
2025-09-17 13:40:37,754 - core.ocr_client - INFO - Starting OCR request caca1044 for merged_20250917_134037_682_25f5ad5c.jpg (0.2MB)
2025-09-17 13:40:37,755 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:40:37,874 - core.ocr_client - ERROR - Non-retryable error for primary-ocr caca1044: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:40:37,875 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:40:37,982 - core.ocr_client - ERROR - Non-retryable error for fallback-vision caca1044: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "be0ef911-dadb-45f6-9ac3-740d2ae54733"
  }
 ]
}

2025-09-17 13:40:37,984 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:40:37,985 - core.ocr_queue - ERROR - Job ocr_F2_1758105637_76669139 failed on attempt 1: OCR processing returned no result
2025-09-17 13:40:37,985 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105637_76669139 for retry in 2s
2025-09-17 13:40:39,986 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105637_76669139 (attempt 2)
2025-09-17 13:40:39,986 - core.ocr_client - INFO - Starting OCR request 0fd88aad for merged_20250917_134037_682_25f5ad5c.jpg (0.2MB)
2025-09-17 13:40:39,987 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:40:40,088 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 0fd88aad: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:40:40,088 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:40:40,187 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 0fd88aad: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "7403ec62-9bfd-4bbc-ad1d-cf3fa057c7b3"
  }
 ]
}

2025-09-17 13:40:40,188 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:40:40,188 - core.ocr_queue - ERROR - Job ocr_F2_1758105637_76669139 failed on attempt 2: OCR processing returned no result
2025-09-17 13:40:40,189 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105637_76669139 for retry in 4s
2025-09-17 13:40:44,190 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105637_76669139 (attempt 3)
2025-09-17 13:40:44,191 - core.ocr_client - INFO - Starting OCR request 5cada534 for merged_20250917_134037_682_25f5ad5c.jpg (0.2MB)
2025-09-17 13:40:44,191 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:40:44,320 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 5cada534: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:40:44,321 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:40:44,478 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 5cada534: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "863abd6a-abdc-4de1-8cc4-5be8287d786b"
  }
 ]
}

2025-09-17 13:40:44,478 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:40:44,479 - core.ocr_queue - ERROR - Job ocr_F2_1758105637_76669139 failed on attempt 3: OCR processing returned no result
2025-09-17 13:40:44,479 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105637_76669139)
2025-09-17 13:40:44,480 - core.ocr_queue - ERROR - Job ocr_F2_1758105637_76669139 permanently failed: OCR processing returned no result
2025-09-17 13:40:47,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:57 MSK)" (scheduled at 2025-09-17 13:40:47.654805+03:00)
2025-09-17 13:40:47,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:47,666 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:40:57 MSK)" executed successfully
2025-09-17 13:40:57,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:07 MSK)" (scheduled at 2025-09-17 13:40:57.654805+03:00)
2025-09-17 13:40:57,666 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:40:57,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:07 MSK)" executed successfully
2025-09-17 13:41:07,661 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:41:37 MSK)" (scheduled at 2025-09-17 13:41:07.651806+03:00)
2025-09-17 13:41:07,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:17 MSK)" (scheduled at 2025-09-17 13:41:07.654805+03:00)
2025-09-17 13:41:07,662 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:41:37 MSK)" executed successfully
2025-09-17 13:41:07,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:07,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:17 MSK)" executed successfully
2025-09-17 13:41:17,656 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:27 MSK)" (scheduled at 2025-09-17 13:41:17.654805+03:00)
2025-09-17 13:41:17,657 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:17,657 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:27 MSK)" executed successfully
2025-09-17 13:41:22,657 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:42:07 MSK)" (scheduled at 2025-09-17 13:41:22.653805+03:00)
2025-09-17 13:41:22,658 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:42:07 MSK)" executed successfully
2025-09-17 13:41:27,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:37 MSK)" (scheduled at 2025-09-17 13:41:27.654805+03:00)
2025-09-17 13:41:27,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:27,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:37 MSK)" executed successfully
2025-09-17 13:41:37,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:42:07 MSK)" (scheduled at 2025-09-17 13:41:37.651806+03:00)
2025-09-17 13:41:37,663 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:42:37 MSK)" (scheduled at 2025-09-17 13:41:37.652805+03:00)
2025-09-17 13:41:37,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:47 MSK)" (scheduled at 2025-09-17 13:41:37.654805+03:00)
2025-09-17 13:41:37,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:42:07 MSK)" executed successfully
2025-09-17 13:41:37,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:37,665 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:41:37,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:47 MSK)" executed successfully
2025-09-17 13:41:37,754 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_134137_691_9fe670a0.jpg (700x1800) in 0.088s
2025-09-17 13:41:37,759 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:41:37,760 - core.database_manager - INFO - Created OCR session 17 for hotkey F2
2025-09-17 13:41:37,760 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105697_0ae91c27 for F2 (session 17)
2025-09-17 13:41:37,760 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105697_0ae91c27 (attempt 1)
2025-09-17 13:41:37,761 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:42:37 MSK)" executed successfully
2025-09-17 13:41:37,761 - core.ocr_client - INFO - Starting OCR request d06351e9 for merged_20250917_134137_691_9fe670a0.jpg (0.2MB)
2025-09-17 13:41:37,762 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:41:37,869 - core.ocr_client - ERROR - Non-retryable error for primary-ocr d06351e9: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:41:37,870 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:41:37,968 - core.ocr_client - ERROR - Non-retryable error for fallback-vision d06351e9: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "70d4bf7b-6438-4d47-9713-58ec8808d4e0"
  }
 ]
}

2025-09-17 13:41:37,969 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:41:37,969 - core.ocr_queue - ERROR - Job ocr_F2_1758105697_0ae91c27 failed on attempt 1: OCR processing returned no result
2025-09-17 13:41:37,969 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105697_0ae91c27 for retry in 2s
2025-09-17 13:41:39,971 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105697_0ae91c27 (attempt 2)
2025-09-17 13:41:39,971 - core.ocr_client - INFO - Starting OCR request 35e20b19 for merged_20250917_134137_691_9fe670a0.jpg (0.2MB)
2025-09-17 13:41:39,972 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:41:40,068 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 35e20b19: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:41:40,069 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:41:40,174 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 35e20b19: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "78c7795a-78df-4c42-a201-c0bee0483c91"
  }
 ]
}

2025-09-17 13:41:40,175 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:41:40,175 - core.ocr_queue - ERROR - Job ocr_F2_1758105697_0ae91c27 failed on attempt 2: OCR processing returned no result
2025-09-17 13:41:40,175 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105697_0ae91c27 for retry in 4s
2025-09-17 13:41:44,177 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105697_0ae91c27 (attempt 3)
2025-09-17 13:41:44,177 - core.ocr_client - INFO - Starting OCR request ea676b1e for merged_20250917_134137_691_9fe670a0.jpg (0.2MB)
2025-09-17 13:41:44,178 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:41:44,284 - core.ocr_client - ERROR - Non-retryable error for primary-ocr ea676b1e: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:41:44,284 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:41:44,389 - core.ocr_client - ERROR - Non-retryable error for fallback-vision ea676b1e: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "04b67325-321b-4cf7-b8fe-a1f75da00c10"
  }
 ]
}

2025-09-17 13:41:44,390 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:41:44,390 - core.ocr_queue - ERROR - Job ocr_F2_1758105697_0ae91c27 failed on attempt 3: OCR processing returned no result
2025-09-17 13:41:44,391 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105697_0ae91c27)
2025-09-17 13:41:44,391 - core.ocr_queue - ERROR - Job ocr_F2_1758105697_0ae91c27 permanently failed: OCR processing returned no result
2025-09-17 13:41:47,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:57 MSK)" (scheduled at 2025-09-17 13:41:47.654805+03:00)
2025-09-17 13:41:47,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:47,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:41:57 MSK)" executed successfully
2025-09-17 13:41:57,660 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:07 MSK)" (scheduled at 2025-09-17 13:41:57.654805+03:00)
2025-09-17 13:41:57,661 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:41:57,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:07 MSK)" executed successfully
2025-09-17 13:42:07,652 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:42:37 MSK)" (scheduled at 2025-09-17 13:42:07.651806+03:00)
2025-09-17 13:42:07,653 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:42:37 MSK)" executed successfully
2025-09-17 13:42:07,668 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:42:52 MSK)" (scheduled at 2025-09-17 13:42:07.653805+03:00)
2025-09-17 13:42:07,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:17 MSK)" (scheduled at 2025-09-17 13:42:07.654805+03:00)
2025-09-17 13:42:07,669 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:42:52 MSK)" executed successfully
2025-09-17 13:42:07,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:07,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:17 MSK)" executed successfully
2025-09-17 13:42:17,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:27 MSK)" (scheduled at 2025-09-17 13:42:17.654805+03:00)
2025-09-17 13:42:17,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:17,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:27 MSK)" executed successfully
2025-09-17 13:42:27,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:37 MSK)" (scheduled at 2025-09-17 13:42:27.654805+03:00)
2025-09-17 13:42:27,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:27,661 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:37 MSK)" executed successfully
2025-09-17 13:42:37,665 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:43:07 MSK)" (scheduled at 2025-09-17 13:42:37.651806+03:00)
2025-09-17 13:42:37,665 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:43:37 MSK)" (scheduled at 2025-09-17 13:42:37.652805+03:00)
2025-09-17 13:42:37,665 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:47 MSK)" (scheduled at 2025-09-17 13:42:37.654805+03:00)
2025-09-17 13:42:37,666 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:43:07 MSK)" executed successfully
2025-09-17 13:42:37,667 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:37,667 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:42:37,667 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:47 MSK)" executed successfully
2025-09-17 13:42:37,772 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_134237_697_2338b6c4.jpg (700x1800) in 0.105s
2025-09-17 13:42:37,777 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:42:37,777 - core.database_manager - INFO - Created OCR session 18 for hotkey F2
2025-09-17 13:42:37,778 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105757_69637af1 for F2 (session 18)
2025-09-17 13:42:37,778 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105757_69637af1 (attempt 1)
2025-09-17 13:42:37,779 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:43:37 MSK)" executed successfully
2025-09-17 13:42:37,779 - core.ocr_client - INFO - Starting OCR request 43bde323 for merged_20250917_134237_697_2338b6c4.jpg (0.2MB)
2025-09-17 13:42:37,780 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:42:37,888 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 43bde323: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:42:37,889 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:42:37,990 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 43bde323: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "767ecb5f-e12e-4667-8100-9eef54227237"
  }
 ]
}

2025-09-17 13:42:37,991 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:42:37,992 - core.ocr_queue - ERROR - Job ocr_F2_1758105757_69637af1 failed on attempt 1: OCR processing returned no result
2025-09-17 13:42:37,992 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105757_69637af1 for retry in 2s
2025-09-17 13:42:39,993 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105757_69637af1 (attempt 2)
2025-09-17 13:42:39,993 - core.ocr_client - INFO - Starting OCR request 2f690e25 for merged_20250917_134237_697_2338b6c4.jpg (0.2MB)
2025-09-17 13:42:39,994 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:42:40,091 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 2f690e25: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:42:40,092 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:42:40,194 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 2f690e25: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "114b62f9-d897-40df-8209-f4852e1a74c6"
  }
 ]
}

2025-09-17 13:42:40,195 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:42:40,195 - core.ocr_queue - ERROR - Job ocr_F2_1758105757_69637af1 failed on attempt 2: OCR processing returned no result
2025-09-17 13:42:40,196 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105757_69637af1 for retry in 4s
2025-09-17 13:42:44,196 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105757_69637af1 (attempt 3)
2025-09-17 13:42:44,197 - core.ocr_client - INFO - Starting OCR request 7791317b for merged_20250917_134237_697_2338b6c4.jpg (0.2MB)
2025-09-17 13:42:44,197 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:42:44,296 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 7791317b: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:42:44,297 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:42:44,405 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 7791317b: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "e2d1738f-0027-4817-9c99-96aeab28d432"
  }
 ]
}

2025-09-17 13:42:44,405 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:42:44,405 - core.ocr_queue - ERROR - Job ocr_F2_1758105757_69637af1 failed on attempt 3: OCR processing returned no result
2025-09-17 13:42:44,406 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105757_69637af1)
2025-09-17 13:42:44,406 - core.ocr_queue - ERROR - Job ocr_F2_1758105757_69637af1 permanently failed: OCR processing returned no result
2025-09-17 13:42:47,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:57 MSK)" (scheduled at 2025-09-17 13:42:47.654805+03:00)
2025-09-17 13:42:47,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:47,664 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:42:57 MSK)" executed successfully
2025-09-17 13:42:52,662 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:43:37 MSK)" (scheduled at 2025-09-17 13:42:52.653805+03:00)
2025-09-17 13:42:52,663 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:43:37 MSK)" executed successfully
2025-09-17 13:42:57,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:07 MSK)" (scheduled at 2025-09-17 13:42:57.654805+03:00)
2025-09-17 13:42:57,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:42:57,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:07 MSK)" executed successfully
2025-09-17 13:43:07,653 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:43:37 MSK)" (scheduled at 2025-09-17 13:43:07.651806+03:00)
2025-09-17 13:43:07,654 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:43:37 MSK)" executed successfully
2025-09-17 13:43:07,668 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:17 MSK)" (scheduled at 2025-09-17 13:43:07.654805+03:00)
2025-09-17 13:43:07,669 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:07,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:17 MSK)" executed successfully
2025-09-17 13:43:17,664 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:27 MSK)" (scheduled at 2025-09-17 13:43:17.654805+03:00)
2025-09-17 13:43:17,665 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:17,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:27 MSK)" executed successfully
2025-09-17 13:43:27,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:37 MSK)" (scheduled at 2025-09-17 13:43:27.654805+03:00)
2025-09-17 13:43:27,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:27,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:37 MSK)" executed successfully
2025-09-17 13:43:37,667 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:44:07 MSK)" (scheduled at 2025-09-17 13:43:37.651806+03:00)
2025-09-17 13:43:37,667 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:44:37 MSK)" (scheduled at 2025-09-17 13:43:37.652805+03:00)
2025-09-17 13:43:37,667 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:44:22 MSK)" (scheduled at 2025-09-17 13:43:37.653805+03:00)
2025-09-17 13:43:37,667 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:47 MSK)" (scheduled at 2025-09-17 13:43:37.654805+03:00)
2025-09-17 13:43:37,669 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:44:07 MSK)" executed successfully
2025-09-17 13:43:37,670 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:44:22 MSK)" executed successfully
2025-09-17 13:43:37,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:37,670 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:43:37,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:47 MSK)" executed successfully
2025-09-17 13:43:37,761 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_134337_696_2285fe7e.jpg (700x1800) in 0.090s
2025-09-17 13:43:37,766 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:43:37,767 - core.database_manager - INFO - Created OCR session 19 for hotkey F2
2025-09-17 13:43:37,768 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105817_4021430c for F2 (session 19)
2025-09-17 13:43:37,768 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105817_4021430c (attempt 1)
2025-09-17 13:43:37,768 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:44:37 MSK)" executed successfully
2025-09-17 13:43:37,769 - core.ocr_client - INFO - Starting OCR request 216e1be0 for merged_20250917_134337_696_2285fe7e.jpg (0.2MB)
2025-09-17 13:43:37,769 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:43:37,879 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 216e1be0: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:43:37,880 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:43:37,987 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 216e1be0: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "a6247d9f-2846-4251-a7f5-72fbe5124bfc"
  }
 ]
}

2025-09-17 13:43:37,988 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:43:37,988 - core.ocr_queue - ERROR - Job ocr_F2_1758105817_4021430c failed on attempt 1: OCR processing returned no result
2025-09-17 13:43:37,988 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105817_4021430c for retry in 2s
2025-09-17 13:43:39,990 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105817_4021430c (attempt 2)
2025-09-17 13:43:39,990 - core.ocr_client - INFO - Starting OCR request fbc1c427 for merged_20250917_134337_696_2285fe7e.jpg (0.2MB)
2025-09-17 13:43:39,991 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:43:40,088 - core.ocr_client - ERROR - Non-retryable error for primary-ocr fbc1c427: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:43:40,089 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:43:40,186 - core.ocr_client - ERROR - Non-retryable error for fallback-vision fbc1c427: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "9767d265-885e-4968-833b-5d62bbda7b14"
  }
 ]
}

2025-09-17 13:43:40,187 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:43:40,188 - core.ocr_queue - ERROR - Job ocr_F2_1758105817_4021430c failed on attempt 2: OCR processing returned no result
2025-09-17 13:43:40,188 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105817_4021430c for retry in 4s
2025-09-17 13:43:44,189 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105817_4021430c (attempt 3)
2025-09-17 13:43:44,189 - core.ocr_client - INFO - Starting OCR request f1915876 for merged_20250917_134337_696_2285fe7e.jpg (0.2MB)
2025-09-17 13:43:44,190 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:43:44,302 - core.ocr_client - ERROR - Non-retryable error for primary-ocr f1915876: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:43:44,302 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:43:44,400 - core.ocr_client - ERROR - Non-retryable error for fallback-vision f1915876: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "24f9026b-ac0d-4827-b818-68ac043e4cba"
  }
 ]
}

2025-09-17 13:43:44,401 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:43:44,402 - core.ocr_queue - ERROR - Job ocr_F2_1758105817_4021430c failed on attempt 3: OCR processing returned no result
2025-09-17 13:43:44,402 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105817_4021430c)
2025-09-17 13:43:44,403 - core.ocr_queue - ERROR - Job ocr_F2_1758105817_4021430c permanently failed: OCR processing returned no result
2025-09-17 13:43:47,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:57 MSK)" (scheduled at 2025-09-17 13:43:47.654805+03:00)
2025-09-17 13:43:47,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:47,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:43:57 MSK)" executed successfully
2025-09-17 13:43:57,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:07 MSK)" (scheduled at 2025-09-17 13:43:57.654805+03:00)
2025-09-17 13:43:57,659 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:43:57,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:07 MSK)" executed successfully
2025-09-17 13:44:07,663 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:44:37 MSK)" (scheduled at 2025-09-17 13:44:07.651806+03:00)
2025-09-17 13:44:07,663 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:17 MSK)" (scheduled at 2025-09-17 13:44:07.654805+03:00)
2025-09-17 13:44:07,664 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:44:37 MSK)" executed successfully
2025-09-17 13:44:07,664 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:07,665 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:17 MSK)" executed successfully
2025-09-17 13:44:17,659 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:27 MSK)" (scheduled at 2025-09-17 13:44:17.654805+03:00)
2025-09-17 13:44:17,660 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:17,660 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:27 MSK)" executed successfully
2025-09-17 13:44:22,660 - apscheduler.executors.default - INFO - Running job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:45:07 MSK)" (scheduled at 2025-09-17 13:44:22.653805+03:00)
2025-09-17 13:44:22,661 - apscheduler.executors.default - INFO - Job "Process F3 screenshots (trigger: interval[0:00:45], next run at: 2025-09-17 13:45:07 MSK)" executed successfully
2025-09-17 13:44:27,662 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:37 MSK)" (scheduled at 2025-09-17 13:44:27.654805+03:00)
2025-09-17 13:44:27,663 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:27,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:37 MSK)" executed successfully
2025-09-17 13:44:37,655 - apscheduler.executors.default - INFO - Running job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:45:07 MSK)" (scheduled at 2025-09-17 13:44:37.651806+03:00)
2025-09-17 13:44:37,655 - apscheduler.executors.default - INFO - Running job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:45:37 MSK)" (scheduled at 2025-09-17 13:44:37.652805+03:00)
2025-09-17 13:44:37,655 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:47 MSK)" (scheduled at 2025-09-17 13:44:37.654805+03:00)
2025-09-17 13:44:37,657 - apscheduler.executors.default - INFO - Job "Process F1 screenshots (trigger: interval[0:00:30], next run at: 2025-09-17 13:45:07 MSK)" executed successfully
2025-09-17 13:44:37,657 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:37,657 - core.image_processor - INFO - Processing 4 screenshots for F2
2025-09-17 13:44:37,657 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:47 MSK)" executed successfully
2025-09-17 13:44:37,726 - core.image_processor - INFO - Successfully merged 3 images into merged_20250917_134437_659_d43862e0.jpg (700x1800) in 0.068s
2025-09-17 13:44:37,730 - core.image_processor - INFO - Cleaned up source files: 4 successful, 0 failed
2025-09-17 13:44:37,731 - core.database_manager - INFO - Created OCR session 20 for hotkey F2
2025-09-17 13:44:37,732 - utils.scheduler - INFO - Submitted OCR job ocr_F2_1758105877_5fa3a8ec for F2 (session 20)
2025-09-17 13:44:37,732 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105877_5fa3a8ec (attempt 1)
2025-09-17 13:44:37,732 - apscheduler.executors.default - INFO - Job "Process F2 screenshots (trigger: interval[0:01:00], next run at: 2025-09-17 13:45:37 MSK)" executed successfully
2025-09-17 13:44:37,732 - core.ocr_client - INFO - Starting OCR request e616b3b4 for merged_20250917_134437_659_d43862e0.jpg (0.2MB)
2025-09-17 13:44:37,733 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:44:37,840 - core.ocr_client - ERROR - Non-retryable error for primary-ocr e616b3b4: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:44:37,840 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:44:37,938 - core.ocr_client - ERROR - Non-retryable error for fallback-vision e616b3b4: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "d1a2eecb-87e4-44fd-b1da-cdfe5c64497e"
  }
 ]
}

2025-09-17 13:44:37,939 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:44:37,939 - core.ocr_queue - ERROR - Job ocr_F2_1758105877_5fa3a8ec failed on attempt 1: OCR processing returned no result
2025-09-17 13:44:37,940 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105877_5fa3a8ec for retry in 2s
2025-09-17 13:44:39,941 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105877_5fa3a8ec (attempt 2)
2025-09-17 13:44:39,941 - core.ocr_client - INFO - Starting OCR request 3097e55c for merged_20250917_134437_659_d43862e0.jpg (0.2MB)
2025-09-17 13:44:39,943 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:44:40,041 - core.ocr_client - ERROR - Non-retryable error for primary-ocr 3097e55c: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:44:40,042 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:44:40,149 - core.ocr_client - ERROR - Non-retryable error for fallback-vision 3097e55c: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "ab60d5f9-493c-4ee5-8dc9-3b15a561b171"
  }
 ]
}

2025-09-17 13:44:40,149 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:44:40,150 - core.ocr_queue - ERROR - Job ocr_F2_1758105877_5fa3a8ec failed on attempt 2: OCR processing returned no result
2025-09-17 13:44:40,150 - core.ocr_queue - INFO - Requeuing job ocr_F2_1758105877_5fa3a8ec for retry in 4s
2025-09-17 13:44:44,152 - core.ocr_queue - INFO - Worker OCRWorker-1 processing job ocr_F2_1758105877_5fa3a8ec (attempt 3)
2025-09-17 13:44:44,153 - core.ocr_client - INFO - Starting OCR request dd50d459 for merged_20250917_134437_659_d43862e0.jpg (0.2MB)
2025-09-17 13:44:44,153 - core.ocr_client - INFO - Trying primary API: ocr format with api_key auth
2025-09-17 13:44:44,251 - core.ocr_client - ERROR - Non-retryable error for primary-ocr dd50d459: HTTP 401: {"error":{"grpcCode":16,"httpCode":401,"message":"Unknown api key 'AQVN****wxyz (5BDA1EF9)'","httpStatus":"Unauthorized","details":[]}}
2025-09-17 13:44:44,252 - core.ocr_client - INFO - Trying fallback API: vision format with bearer auth
2025-09-17 13:44:44,349 - core.ocr_client - ERROR - Non-retryable error for fallback-vision dd50d459: HTTP 401: {
 "code": 16,
 "message": "The token is invalid",
 "details": [
  {
   "@type": "type.googleapis.com/google.rpc.RequestInfo",
   "requestId": "f67dbb8f-5a20-4154-af68-fb702148f957"
  }
 ]
}

2025-09-17 13:44:44,349 - core.ocr_client - ERROR - Fallback API (vision) also failed
2025-09-17 13:44:44,350 - core.ocr_queue - ERROR - Job ocr_F2_1758105877_5fa3a8ec failed on attempt 3: OCR processing returned no result
2025-09-17 13:44:44,351 - utils.scheduler - ERROR - OCR failed for F2: OCR processing returned no result (OCR job ocr_F2_1758105877_5fa3a8ec)
2025-09-17 13:44:44,351 - core.ocr_queue - ERROR - Job ocr_F2_1758105877_5fa3a8ec permanently failed: OCR processing returned no result
2025-09-17 13:44:47,669 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:57 MSK)" (scheduled at 2025-09-17 13:44:47.654805+03:00)
2025-09-17 13:44:47,670 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:47,670 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:44:57 MSK)" executed successfully
2025-09-17 13:44:57,661 - apscheduler.executors.default - INFO - Running job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:45:07 MSK)" (scheduled at 2025-09-17 13:44:57.654805+03:00)
2025-09-17 13:44:57,662 - utils.scheduler - INFO - Status check cycle completed: 0 transitions, 0 inactive combinations removed
2025-09-17 13:44:57,663 - apscheduler.executors.default - INFO - Job "Status check and transition cycle (trigger: interval[0:00:10], next run at: 2025-09-17 13:45:07 MSK)" executed successfully
2025-09-17 13:45:00,266 - main - WARNING - Monitoring engine health issues: ['No items in monitoring queue']
2025-09-17 13:45:00,266 - main - WARNING - Periodic health check failed: 'int' object has no attribute 'name'
2025-09-17 13:45:03,816 - main - INFO - Received SIGINT, initiating shutdown...
2025-09-17 13:45:03,816 - main - INFO - Shutting down Market Monitoring System...
2025-09-17 13:45:03,817 - main - INFO - Stopping task scheduler...
2025-09-17 13:45:03,817 - utils.scheduler - INFO - Stopping task scheduler
2025-09-17 13:45:03,818 - apscheduler.scheduler - INFO - Scheduler has been shut down
2025-09-17 13:45:03,818 - utils.scheduler - INFO - Task scheduler stopped
2025-09-17 13:45:03,818 - main - INFO - Stopping screenshot capture...
2025-09-17 13:45:03,819 - core.screenshot_capture - ERROR - Error closing MSS instance: '_thread._local' object has no attribute 'bmp'
2025-09-17 13:45:03,819 - core.screenshot_capture - INFO - Screenshot capture system stopped
2025-09-17 13:45:03,820 - main - INFO - Stopping OCR queue...
2025-09-17 13:45:03,820 - core.ocr_queue - INFO - Stopping OCR queue...
2025-09-17 13:45:04,501 - main - INFO - Received SIGINT, initiating shutdown...
2025-09-17 13:45:04,501 - main - INFO - Shutting down Market Monitoring System...
2025-09-17 13:45:04,502 - main - INFO - Stopping task scheduler...
2025-09-17 13:45:04,502 - main - INFO - Stopping screenshot capture...
2025-09-17 13:45:04,502 - main - INFO - Stopping OCR queue...
2025-09-17 13:45:04,503 - main - INFO - Closing OCR client...
2025-09-17 13:45:04,505 - core.ocr_client - INFO - OCR client closed
2025-09-17 13:45:04,506 - main - INFO - Closing database connections...
2025-09-17 13:45:04,507 - main - INFO - System shutdown completed
2025-09-17 13:45:04,507 - core.ocr_queue - INFO - OCR queue stopped
2025-09-17 13:45:04,507 - main - INFO - Closing OCR client...
2025-09-17 13:45:04,508 - core.ocr_client - INFO - OCR client closed
2025-09-17 13:45:04,508 - main - INFO - Closing database connections...
2025-09-17 13:45:04,508 - main - INFO - System shutdown completed
